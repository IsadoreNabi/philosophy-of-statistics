<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>PHILOSOPHY OF STATISTICS — Lab Notes</title>
<link>https://IsadoreNabi.github.io/philosophy-of-statistics/</link>
<atom:link href="https://IsadoreNabi.github.io/philosophy-of-statistics/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.8.24</generator>
<lastBuildDate>Thu, 18 Sep 2025 06:00:00 GMT</lastBuildDate>
<item>
  <title>topologyR: A Topology-First Guardrail for Time-Series Imputation and Modeling</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-19-topologyR/</link>
  <description><![CDATA[ 





<section id="problem-motivation-a-topology-first-guardrail" class="level2">
<h2 class="anchored" data-anchor-id="problem-motivation-a-topology-first-guardrail">1. Problem &amp; Motivation: A Topology-First Guardrail</h2>
<p>Many workflows jump straight into smoothing, imputation, or global trend estimation <strong>without</strong> checking whether the data behave as a single connected system. <strong>topologyR</strong> elevates local metric information (adjacent distances) into neighborhoods → base → full topology, then poses a decisive question: <em>Is the induced topology connected?</em> If <strong>yes</strong>, global continuity assumptions are supported; if <strong>no</strong>, you must <strong>segment</strong> and analyze components separately. This is the package’s central guardrail and value proposition. </p>
<p>Concretely, topologyR provides a pipeline to: (i) build subbases/bases from numeric data with tunable thresholds, (ii) derive the induced topology and quantify its complexity, (iii) run undirected/directed/coverage connectivity checks, and (iv) explore how threshold choices change structure. </p>
</section>
<section id="formal-definitions" class="level2">
<h2 class="anchored" data-anchor-id="formal-definitions">2. Formal Definitions</h2>
<p><strong>Topological space.</strong> Given a set <img src="https://latex.codecogs.com/png.latex?X">, a topology <img src="https://latex.codecogs.com/png.latex?%5Ctau"> on <img src="https://latex.codecogs.com/png.latex?X"> is a family of subsets (the <em>open</em> sets) that contains <img src="https://latex.codecogs.com/png.latex?%5Cemptyset"> and <img src="https://latex.codecogs.com/png.latex?X"> and is closed under arbitrary unions and finite intersections; <img src="https://latex.codecogs.com/png.latex?(X,%5Ctau)"> is a <strong>topological space</strong>. </p>
<p><strong>Base &amp; subbase (intuitive).</strong> From data, we form <strong>neighborhoods</strong> under a threshold <img src="https://latex.codecogs.com/png.latex?%5Ctau"> (not the topology!), take <strong>finite intersections</strong> to form a <strong>base</strong>, and from unions of base elements obtain the <strong>full topology</strong>. In topologyR this is done explicitly from a numeric vector. </p>
<p><strong>Connectivity (β₀).</strong> We study whether the induced topology connects all present indices under either undirected or directed reachability, or at least <strong>covers</strong> all indices (manual check). </p>
</section>
<section id="topologyr-pipeline-what-the-package-builds-for-you" class="level2">
<h2 class="anchored" data-anchor-id="topologyr-pipeline-what-the-package-builds-for-you">3. topologyR Pipeline: What the package builds for you?</h2>
<ol type="1">
<li><p><strong>Neighborhoods</strong> under a tunable threshold (e.g., IQR-based)</p></li>
<li><p><strong>Base</strong> via intersections (include empty/full sets for correctness)</p></li>
<li><p><strong>Full topology</strong> from the base (closure under unions/finite intersections)</p></li>
<li><p><strong>Connectivity</strong> checks: undirected DFS, directed DFS, manual coverage</p></li>
<li><p><strong>Threshold exploration</strong> (mean/median diffs, SD, IQR/factor, DBSCAN-like) and <strong>factor sweep</strong> summaries/plots </p></li>
</ol>
<p>A compact R-sketch of the core algorithm appears below (the package implements a robust version): </p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Neighborhoods under τ</span></span>
<span id="cb1-2">subbase <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> τ))</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base: include ∅ and X</span></span>
<span id="cb1-5">base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x))</span>
<span id="cb1-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x)) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)) {</span>
<span id="cb1-7">  S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(subbase[[i]], subbase[[j]])</span>
<span id="cb1-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(S) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(base, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(S))</span>
<span id="cb1-9">}</span>
<span id="cb1-10">base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(base)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From the base -&gt; topology (unions/finite intersections)</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Connectivity checks:</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is_topology_connected(topology)         # undirected DFS</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is_topology_connected2(topology)        # directed DFS (sequential)</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is_topology_connected_manual(topology)  # coverage 1..n</span></span></code></pre></div></div>
</section>
<section id="key-innovation" class="level2">
<h2 class="anchored" data-anchor-id="key-innovation">4. Key Innovation</h2>
<section id="revealing-topological-invariants-to-validate-imputation-methods" class="level3">
<h3 class="anchored" data-anchor-id="revealing-topological-invariants-to-validate-imputation-methods">4.1. Revealing Topological Invariants to Validate Imputation Methods</h3>
<section id="introduction-the-fundamental-problem" class="level4">
<h4 class="anchored" data-anchor-id="introduction-the-fundamental-problem">4.1.1. Introduction: The Fundamental Problem</h4>
<p>We often assume global continuity (smoothing, kriging, splines, etc.) <strong>before</strong> verifying whether continuity is even mathematically defensible. topologyR fixes this by elevating local distances into a topology and reading off invariants (notably <strong>connectedness</strong>) that decide method validity. </p>
</section>
<section id="conceptual-foundations" class="level4">
<h4 class="anchored" data-anchor-id="conceptual-foundations">4.1.2. Conceptual Foundations</h4>
<p><strong>4.1.2.1. The Nature of The Problem.</strong> Sequential data hide global properties critical for method choice: system connectivity, structural complexity, and breakpoints that may invalidate continuity. These are not visible from pairwise distances alone. </p>
<p><strong>4.1.2.2. The Topological Solution.</strong></p>
<ol type="1">
<li>Metric proximity → <strong>neighborhood relations</strong></li>
<li>Neighborhoods → <strong>subbase</strong></li>
<li>Intersections/unions → <strong>base</strong> and <strong>full topology</strong></li>
<li>Topology → <strong>invariants</strong> (connectivity) that govern method validity. </li>
</ol>
</section>
<section id="the-theoretical-framework-connectivity-method-validity" class="level4">
<h4 class="anchored" data-anchor-id="the-theoretical-framework-connectivity-method-validity">4.1.3. The Theoretical Framework: Connectivity ⇒ Method Validity</h4>
<p><strong>Case I: Connected Topology.</strong> Valid to use global continuous methods (polynomial/linear interpolation, cubic splines, kriging/geostatistics, moving averages, continuous kernels), assuming adequate sampling/noise. </p>
<p><strong>Case II: Disconnected topology.</strong> Global continuity is invalid; you must switch to <strong>segment-wise</strong> or <strong>regime</strong> approaches (independent imputation per component, regime-switching, conditional-by-segment, hot-deck within component, finite mixtures). </p>
</section>
<section id="global-vs-local-properties" class="level4">
<h4 class="anchored" data-anchor-id="global-vs-local-properties">4.1.4. Global vs Local Properties</h4>
<p><strong>Global</strong> properties (full-period means, secular trend, systemic volatility, cycle structure, cointegration, long memory, global neural synchrony, centennial climate trends, circulation patterns) <strong>require</strong> connectivity; a disconnected topology invalidates global continuous imputation across the break. <strong>Local</strong> properties (short-window volatility, local derivatives, local clustering, AR(1)/AR(2) at short lags, local inflection points, short-segment spectra) can be analyzed per component regardless of global connectedness. </p>
</section>
<section id="critical-applications-by-domain" class="level4">
<h4 class="anchored" data-anchor-id="critical-applications-by-domain">4.1.5. Critical Applications by Domain</h4>
<ul>
<li><strong>Econometrics.</strong> Disconnections mark structural crises; avoid trends that cross discontinuities.</li>
<li><strong>Medicine/Neuroscience.</strong> Interventions can split regimes; test continuity before longitudinal pooling.</li>
<li><strong>Climatology.</strong> Extreme events can sever continuity; don’t extrapolate trends across regimes. </li>
</ul>
</section>
<section id="fundamental-decision-rule" class="level4">
<h4 class="anchored" data-anchor-id="fundamental-decision-rule">4.1.6. Fundamental Decision Rule</h4>
<ol type="1">
<li>Global analyses: <strong>connectivity is necessary</strong> for continuous methods.</li>
<li>Local analyses: use continuous methods <strong>within each component</strong>.</li>
<li>Mixed: segment globally; apply local continuous tools inside each segment. </li>
</ol>
</section>
<section id="conclusions-on-the-fundamental-contribution" class="level4">
<h4 class="anchored" data-anchor-id="conclusions-on-the-fundamental-contribution">4.1.7. Conclusions On the Fundamental Contribution</h4>
<p>topologyR transforms imputation from heuristic to <strong>mathematically grounded</strong> procedure by revealing the underlying topological structure that justifies (or forbids) continuity assumptions before application — crucial in policy, biomedical, and climate contexts. </p>
</section>
<section id="positioning-vs-general-purpose-tda" class="level4">
<h4 class="anchored" data-anchor-id="positioning-vs-general-purpose-tda">4.1.8. Positioning vs General-Purpose TDA</h4>
<p>Focus: 1D series, <strong>β₀</strong> (connectedness), explicit decision rule. Complement PH stacks (Ripser/GUDHI/TDAstats/scikit-TDA) for multi-scale/higher-β structure (no explicit imputation rule). </p>
</section>
<section id="limitations-and-risks" class="level4">
<h4 class="anchored" data-anchor-id="limitations-and-risks">4.1.9. Limitations and Risks</h4>
<ol type="1">
<li><p><strong>Parameter Sensitivity</strong> (threshold choice) → mitigate via factor sweeps; still empirical.</p></li>
<li><p><strong>Sampling/noise</strong> can mimic (dis)connection → treat “connected ⇒ continuous” as <strong>prima facie</strong>.</p></li>
<li><p><strong>Expressivity</strong> limited to <strong>β₀</strong>.</p></li>
<li><p><strong>Scalability</strong>: exhaustive builds can be <img src="https://latex.codecogs.com/png.latex?O(n%5E2)">. </p></li>
</ol>
</section>
<section id="global-conclusions-practical-guidance" class="level4">
<h4 class="anchored" data-anchor-id="global-conclusions-practical-guidance">4.1.10. Global conclusions &amp; practical guidance</h4>
<p>Use topologyR as a <strong>pre-model governance</strong> tool for binary <strong>validity</strong> decisions; complement with PH for subtle multi-scale features that don’t break global connectedness. </p>
</section>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">4.1.11. References</h4>
<p>Alvarado, E., Beckelhymer, D., Dorrington, J., Lam, T., Majhi, S., Noory, J., Sánchez Muniz, M., &amp; Strømmen, K. (2025). <em>Detecting the Indian Monsoon using Topological Data Analysis</em> (arXiv:2504.01022). https://arxiv.org/abs/2504.01022</p>
<p>Bauer, U. (2021). Ripser: Efficient computation of Vietoris–Rips persistence barcodes. <em>Journal of Applied and Computational Topology, 5</em>(3), 391–423. https://doi.org/10.1007/s41468-021-00071-5</p>
<p>Chung, M. K., et al.&nbsp;(2023). Unified topological inference for brain networks in temporal dynamics. <em>Frontiers in Neuroscience, 17</em>, 1140289. https://doi.org/10.3389/fnins.2023.1140289</p>
<p>Flammer, M., et al.&nbsp;(2023). Persistent homology-based classification of chaotic multivariate time series: Application to electroencephalograms. <em>SN Computer Science, 4</em>, 396. https://doi.org/10.1007/s42979-023-02396-7</p>
<p>Gidea, M. (2017). <em>Topological data analysis of financial time series</em> (arXiv:1703.04385). https://arxiv.org/abs/1703.04385</p>
<p>Guo, H., et al.&nbsp;(2020). Empirical study of financial crises based on topological data analysis. <em>Physica A: Statistical Mechanics and its Applications, 551</em>, 124198. https://doi.org/10.1016/j.physa.2019.124198</p>
<p>Kang, Y., et al.&nbsp;(2024). High-order brain network feature extraction and characterization via persistent homology. <em>Frontiers in Neuroscience, 18</em>, 1378837. https://doi.org/10.3389/fnins.2024.1378837</p>
<p>Kelley, J. L. (2017). <em>General topology</em> (Dover ed.; original work published 1955). Dover Publications.</p>
<p>Maria, C., Boissonnat, J.-D., Glisse, M., &amp; Yvinec, M. (2014). The GUDHI library: Simplicial complexes and persistent homology. In H. Hong &amp; C. Yap (Eds.), <em>Mathematical Software – ICMS 2014</em> (pp.&nbsp;167–174). Springer. https://doi.org/10.1007/978-3-662-44199-2_28</p>
<p>Otter, N., Porter, M. A., Tillmann, U., Grindrod, P., &amp; Harrington, H. A. (2017). A roadmap for the computation of persistent homology. <em>EPJ Data Science, 6</em>, 17. https://doi.org/10.1140/epjds/s13688-017-0109-5</p>
<p>scikit-TDA. (n.d.). <em>scikit-TDA documentation</em>. https://docs.scikit-tda.org/</p>
<p>Tralie, C., Saul, N., &amp; Bar-On, R. (2018). ripser.py: A lean persistent homology library for Python. <em>Journal of Open Source Software, 3</em>(29), 925. https://doi.org/10.21105/joss.00925</p>
<p>Tymochko, S., et al.&nbsp;(2020). Using persistent homology to quantify a diurnal cycle in tropical cyclone convection. <em>Pattern Recognition Letters, 133</em>, 137–143. https://doi.org/10.1016/j.patrec.2020.02.003</p>
<p>Ver Hoef, L., et al.&nbsp;(2023). A primer on topological data analysis to support image segmentation and feature extraction for environmental science. <em>AI for the Earth Systems, 2</em>(1), e220039. https://doi.org/10.1175/AIES-D-22-0039.1</p>
<p>Wadhwa, R. R., Williamson, D. F. K., Dhawan, A., &amp; Scott, J. G. (2018). TDAstats: R pipeline for computing persistent homology in topological data analysis. <em>Journal of Open Source Software, 3</em>(28), 860. https://doi.org/10.21105/joss.00860</p>
<p>Wang, Z., et al.&nbsp;(2023). Automatic epileptic seizure detection based on persistent homology. <em>Computational and Mathematical Methods in Medicine, 2023</em>, 9165842. https://doi.org/10.1155/2023/9165842</p>
<p>Xu, X., Gao, Y., Zhong, S., Li, P., &amp; Wang, Y. (2021). Topological data analysis as a new tool for EEG processing. <em>Frontiers in Neuroscience, 15</em>, 761703. https://doi.org/10.3389/fnins.2021.761703</p>
</section>
</section>
</section>
<section id="scope-typical-use-cases" class="level2">
<h2 class="anchored" data-anchor-id="scope-typical-use-cases">5. Scope &amp; Typical Use Cases</h2>
<ul>
<li><strong>Economic &amp; other time series</strong>: connectivity regimes, structural breaks.</li>
<li><strong>Signal/biological data</strong>: neighborhood graphs, coverage checks.</li>
<li><strong>Didactic</strong>: bases/subbases, topology construction, graph↔︎topology bridges. </li>
</ul>
</section>
<section id="design-principles" class="level2">
<h2 class="anchored" data-anchor-id="design-principles">6. Design Principles</h2>
<p>Correctness (include ∅ and <img src="https://latex.codecogs.com/png.latex?X">; track coverage), transparency (step-wise functions), explorability (fast heuristics &amp; visuals for threshold selection). </p>
</section>
<section id="technical-approach-algorithms-connectivity-engines" class="level2">
<h2 class="anchored" data-anchor-id="technical-approach-algorithms-connectivity-engines">7. Technical Approach: Algorithms &amp; Connectivity Engines</h2>
<p><strong>Core Algorithm</strong> and <strong>Methods</strong> (undirected DFS; directed sequential DFS; manual coverage) as sketched in §3 above. </p>
<p><strong>Connectivity Functions (Package Internals).</strong></p>
<ul>
<li><p><code>is_topology_connected()</code> builds a symmetric adjacency from set co-membership and runs DFS over present elements.</p></li>
<li><p><code>is_topology_connected2()</code> directs edges along sorted, consecutive elements within each set and DFSs from the minimum.</p></li>
<li><p><code>is_topology_connected_manual()</code> checks whether each original index 1..n appears in at least one set. </p></li>
</ul>
</section>
<section id="api-at-a-glance-quick-start" class="level2">
<h2 class="anchored" data-anchor-id="api-at-a-glance-quick-start">8. API at A Glance (Quick Start)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(topologyR)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Small example vector</span></span>
<span id="cb2-4">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build a complete topology and check connectivity</span></span>
<span id="cb2-7">topo     <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete_topology</span>(x)</span>
<span id="cb2-8">undirected <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb2-9">directed   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected2</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb2-10">manual     <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected_manual</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Threshold exploration and factor sweep</span></span>
<span id="cb2-13">ths <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_thresholds</span>(x)</span>
<span id="cb2-14">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_topology_factors</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>))</span>
<span id="cb2-15">viz <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visualize_topology_thresholds</span>(x)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optional visuals</span></span></code></pre></div></div>
</section>
<section id="threshold-heuristics-factor-sweep" class="level2">
<h2 class="anchored" data-anchor-id="threshold-heuristics-factor-sweep">9. Threshold Heuristics &amp; Factor Sweep</h2>
<p>You can derive τ from <strong>mean/median adjacent differences</strong>, <strong>SD</strong>, <strong>IQR / factor</strong>, or a <strong>DBSCAN-like</strong> heuristic; then run an <strong>IQR-factor sweep</strong> (e.g., 1, 2, 4, 8, 16) and track <strong>base size / set sizes</strong> to pick a stable regime. </p>
<p>Internally, the factor sweep computes <img src="https://latex.codecogs.com/png.latex?%5Ctau=%5Cmathrm%7BIQR%7D(x)/f">, builds subbases, forms the base (with ∅ and <img src="https://latex.codecogs.com/png.latex?X">), and summarizes base size and min/max set sizes per <img src="https://latex.codecogs.com/png.latex?f">. </p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span>
<span id="cb3-3"></span>
<span id="cb3-4">ths  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_thresholds</span>(x)</span>
<span id="cb3-5">resf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_topology_factors</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(ths)</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(resf)</span></code></pre></div></div>
</section>
<section id="performance-scalability" class="level2">
<h2 class="anchored" data-anchor-id="performance-scalability">10. Performance &amp; Scalability</h2>
<p>Exact neighborhood/base construction can grow as <img src="https://latex.codecogs.com/png.latex?O(n%5E2)">; prefer robust thresholds + factor sweeps, and consider down-sampling beyond moderate <img src="https://latex.codecogs.com/png.latex?n">. For first-pass diagnostics on very large data, use the <strong>manual coverage</strong> check and then refine with directed DFS as needed. </p>
</section>
<section id="limitations-validity-notes" class="level2">
<h2 class="anchored" data-anchor-id="limitations-validity-notes">11. Limitations &amp; Validity Notes</h2>
<ul>
<li><p><strong>Threshold Sensitivity</strong>: false (dis)connections if τ is mis-set → mitigate with grids, but keep domain judgment.</p></li>
<li><p><strong>Sampling/noise</strong>: sparse sampling may mimic disconnections; light overlaps may mimic connection → treat “connected ⇒ continuous” as <strong>prima facie</strong>, not absolute.</p></li>
<li><p><strong>Expressivity</strong>: emphasis on <strong>β₀</strong>; higher-order features require PH stacks.</p></li>
<li><p><strong>Assumptions</strong>: sequential indices 1..n; very large topologies can be memory-intensive. </p></li>
</ul>
</section>
<section id="end-to-end-example-imputation-decision" class="level2">
<h2 class="anchored" data-anchor-id="end-to-end-example-imputation-decision">12. End-To-End Example: Imputation Decision</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(topologyR)</span>
<span id="cb4-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AirPassengers)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transparent, robust default for τ and illustrative factor sweep</span></span>
<span id="cb4-5">ths  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_thresholds</span>(x)</span>
<span id="cb4-6">res  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_topology_factors</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8">tau  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb4-9">topo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete_topology</span>(x)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for small n; otherwise use thresholded subbases</span></span>
<span id="cb4-10"></span>
<span id="cb4-11">is_conn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb4-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (is_conn) {</span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Connected: using global continuous imputation."</span>)</span>
<span id="cb4-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># e.g., stats::spline(...), global kriging, smoothers</span></span>
<span id="cb4-15">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disconnected: segment-wise imputation &amp; regime models."</span>)</span>
<span id="cb4-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># split by connected components; impute/model per segment</span></span>
<span id="cb4-18">}</span></code></pre></div></div>
</section>
<section id="positioning-vs.-general-purpose-tda" class="level2">
<h2 class="anchored" data-anchor-id="positioning-vs.-general-purpose-tda">13. Positioning vs.&nbsp;General-Purpose TDA</h2>
<p>topologyR is a <strong>focused</strong>, decision-oriented pre-model tool for <strong>1D series</strong> (β₀/connectedness). For multi-scale/higher-β structure or early-warning signals, complement with <strong>Ripser/GUDHI/TDAstats/scikit-TDA</strong>. </p>
<p><em>(Key external sources listed in the Wiki’s references subsection 4.1.11. of the library)</em> </p>
</section>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">14. Installation</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">remotes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IsadoreNabi/topologyR"</span>)</span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># or local build</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setwd("/path/to/topologyR"); library(devtools); library(roxygen2); document(); install()</span></span></code></pre></div></div>
</section>
<section id="license-and-author" class="level2">
<h2 class="anchored" data-anchor-id="license-and-author">15. License and Author</h2>
<p><strong>LICENSE:</strong> MIT License — see LICENSE in the repository.</p>
<p><strong>AUTHOR:</strong> José Mauricio Gómez Julián.</p>


</section>

 ]]></description>
  <category>R</category>
  <category>topology</category>
  <category>time-series</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-19-topologyR/</guid>
  <pubDate>Thu, 18 Sep 2025 06:00:00 GMT</pubDate>
</item>
<item>
  <title>topologyR: Una Salvaguarda Basada en Topología para Imputación y Modelado de Series Temporales</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-19-topologyR-esp/</link>
  <description><![CDATA[ 





<section id="problema-y-motivación-una-salvaguarda-basada-en-topología" class="level2">
<h2 class="anchored" data-anchor-id="problema-y-motivación-una-salvaguarda-basada-en-topología">1. Problema y Motivación: Una Salvaguarda Basada en Topología</h2>
<p>Muchos flujos de trabajo saltan directamente al suavizado, imputación o estimación de tendencias globales <strong>sin</strong> verificar si los datos se comportan como un sistema conectado único. <strong>topologyR</strong> eleva la información métrica local (distancias adyacentes) a vecindarios → base → topología completa, y luego plantea una pregunta decisiva: <em>¿La topología inducida está conectada?</em> Si la respuesta es <strong>sí</strong>, las suposiciones de continuidad global están respaldadas; si es <strong>no</strong>, debes <strong>segmentar</strong> y analizar los componentes por separado. Esta es la salvaguarda central y la propuesta de valor del paquete.</p>
<p>Concretamente, topologyR proporciona un pipeline para: (i) construir subbases/bases a partir de datos numéricos con umbrales ajustables, (ii) derivar la topología inducida y cuantificar su complejidad, (iii) ejecutar verificaciones de conectividad no dirigida/dirigida/de cobertura, y (iv) explorar cómo las elecciones de umbral cambian la estructura.</p>
</section>
<section id="definiciones-formales" class="level2">
<h2 class="anchored" data-anchor-id="definiciones-formales">2. Definiciones Formales</h2>
<p><strong>Espacio topológico.</strong> Dado un conjunto <img src="https://latex.codecogs.com/png.latex?X">, una topología <img src="https://latex.codecogs.com/png.latex?%5Ctau"> sobre <img src="https://latex.codecogs.com/png.latex?X"> es una familia de subconjuntos (los conjuntos <em>abiertos</em>) que contiene <img src="https://latex.codecogs.com/png.latex?%5Cemptyset"> y <img src="https://latex.codecogs.com/png.latex?X"> y está cerrada bajo uniones arbitrarias e intersecciones finitas; <img src="https://latex.codecogs.com/png.latex?(X,%5Ctau)"> es un <strong>espacio topológico</strong>.</p>
<p><strong>Base y subbase (intuitivo).</strong> A partir de los datos, formamos <strong>vecindarios</strong> bajo un umbral <img src="https://latex.codecogs.com/png.latex?%5Ctau"> (¡no la topología!), tomamos <strong>intersecciones finitas</strong> para formar una <strong>base</strong>, y a partir de uniones de elementos de la base obtenemos la <strong>topología completa</strong>. En topologyR esto se hace explícitamente desde un vector numérico.</p>
<p><strong>Conectividad (β₀).</strong> Estudiamos si la topología inducida conecta todos los índices presentes bajo alcanzabilidad no dirigida o dirigida, o al menos <strong>cubre</strong> todos los índices (verificación manual).</p>
</section>
<section id="pipeline-de-topologyr-qué-construye-el-paquete-para-ti" class="level2">
<h2 class="anchored" data-anchor-id="pipeline-de-topologyr-qué-construye-el-paquete-para-ti">3. Pipeline de topologyR: ¿Qué construye el paquete para ti?</h2>
<ol type="1">
<li><p><strong>Vecindarios</strong> bajo un umbral ajustable (ej., basado en IQR)</p></li>
<li><p><strong>Base</strong> mediante intersecciones (incluir conjuntos vacío/completo para corrección)</p></li>
<li><p><strong>Topología completa</strong> a partir de la base (clausura bajo uniones/intersecciones finitas)</p></li>
<li><p><strong>Verificaciones de conectividad</strong>: DFS no dirigido, DFS dirigido, cobertura manual</p></li>
<li><p><strong>Exploración de umbrales</strong> (diferencias media/mediana, SD, IQR/factor, similar a DBSCAN) y resúmenes/gráficos de <strong>barrido de factores</strong></p></li>
</ol>
<p>Un bosquejo R compacto del algoritmo central aparece a continuación (el paquete implementa una versión robusta):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vecindarios bajo τ</span></span>
<span id="cb1-2">subbase <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> τ))</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base: incluir ∅ y X</span></span>
<span id="cb1-5">base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x))</span>
<span id="cb1-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(x)) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)) {</span>
<span id="cb1-7">  S <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(subbase[[i]], subbase[[j]])</span>
<span id="cb1-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(S) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(base, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(S))</span>
<span id="cb1-9">}</span>
<span id="cb1-10">base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(base)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># De la base -&gt; topología (uniones/intersecciones finitas)</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verificaciones de conectividad:</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is_topology_connected(topology)         # DFS no dirigido</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is_topology_connected2(topology)        # DFS dirigido (secuencial)</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is_topology_connected_manual(topology)  # cobertura 1..n</span></span></code></pre></div></div>
</section>
<section id="innovación-clave" class="level2">
<h2 class="anchored" data-anchor-id="innovación-clave">4. Innovación Clave</h2>
<section id="revelando-invariantes-topológicos-para-validar-métodos-de-imputación" class="level3">
<h3 class="anchored" data-anchor-id="revelando-invariantes-topológicos-para-validar-métodos-de-imputación">4.1. Revelando Invariantes Topológicos para Validar Métodos de Imputación</h3>
<section id="introducción-el-problema-fundamental" class="level4">
<h4 class="anchored" data-anchor-id="introducción-el-problema-fundamental">4.1.1. Introducción: El Problema Fundamental</h4>
<p>A menudo asumimos continuidad global (suavizado, kriging, splines, etc.) <strong>antes</strong> de verificar si la continuidad es siquiera matemáticamente defendible. topologyR arregla esto elevando las distancias locales a una topología y leyendo invariantes (notablemente <strong>conectividad</strong>) que deciden la validez del método.</p>
</section>
<section id="fundamentos-conceptuales" class="level4">
<h4 class="anchored" data-anchor-id="fundamentos-conceptuales">4.1.2. Fundamentos Conceptuales</h4>
<p><strong>4.1.2.1. La Naturaleza del Problema.</strong> Los datos secuenciales ocultan propiedades globales críticas para la elección de método: conectividad del sistema, complejidad estructural y puntos de quiebre que pueden invalidar la continuidad. Estos no son visibles solo a partir de distancias por pares.</p>
<p><strong>4.1.2.2. La Solución Topológica.</strong></p>
<ol type="1">
<li>Proximidad métrica → <strong>relaciones de vecindario</strong></li>
<li>Vecindarios → <strong>subbase</strong></li>
<li>Intersecciones/uniones → <strong>base</strong> y <strong>topología completa</strong></li>
<li>Topología → <strong>invariantes</strong> (conectividad) que gobiernan la validez del método.</li>
</ol>
</section>
<section id="el-marco-teórico-conectividad-validez-del-método" class="level4">
<h4 class="anchored" data-anchor-id="el-marco-teórico-conectividad-validez-del-método">4.1.3. El Marco Teórico: Conectividad ⇒ Validez del Método</h4>
<p><strong>Caso I: Topología Conectada.</strong> Válido usar métodos continuos globales (interpolación polinomial/lineal, splines cúbicos, kriging/geoestadística, promedios móviles, kernels continuos), asumiendo muestreo/ruido adecuado.</p>
<p><strong>Caso II: Topología desconectada.</strong> La continuidad global es inválida; debes cambiar a enfoques <strong>por segmentos</strong> o <strong>regímenes</strong> (imputación independiente por componente, cambio de régimen, condicional por segmento, hot-deck dentro del componente, mezclas finitas).</p>
</section>
<section id="propiedades-globales-vs-locales" class="level4">
<h4 class="anchored" data-anchor-id="propiedades-globales-vs-locales">4.1.4. Propiedades Globales vs Locales</h4>
<p>Las propiedades <strong>globales</strong> (medias de período completo, tendencia secular, volatilidad sistémica, estructura de ciclos, cointegración, memoria larga, sincronía neural global, tendencias climáticas centenarias, patrones de circulación) <strong>requieren</strong> conectividad; una topología desconectada invalida la imputación continua global a través del quiebre. Las propiedades <strong>locales</strong> (volatilidad de ventana corta, derivadas locales, agrupamiento local, AR(1)/AR(2) en rezagos cortos, puntos de inflexión locales, espectros de segmento corto) pueden analizarse por componente independientemente de la conectividad global.</p>
</section>
<section id="aplicaciones-críticas-por-dominio" class="level4">
<h4 class="anchored" data-anchor-id="aplicaciones-críticas-por-dominio">4.1.5. Aplicaciones Críticas por Dominio</h4>
<ul>
<li><strong>Econometría.</strong> Las desconexiones marcan crisis estructurales; evitar tendencias que crucen discontinuidades.</li>
<li><strong>Medicina/Neurociencia.</strong> Las intervenciones pueden dividir regímenes; probar continuidad antes del agrupamiento longitudinal.</li>
<li><strong>Climatología.</strong> Los eventos extremos pueden cortar la continuidad; no extrapolar tendencias a través de regímenes.</li>
</ul>
</section>
<section id="regla-de-decisión-fundamental" class="level4">
<h4 class="anchored" data-anchor-id="regla-de-decisión-fundamental">4.1.6. Regla de Decisión Fundamental</h4>
<ol type="1">
<li>Análisis globales: <strong>la conectividad es necesaria</strong> para métodos continuos.</li>
<li>Análisis locales: usar métodos continuos <strong>dentro de cada componente</strong>.</li>
<li>Mixto: segmentar globalmente; aplicar herramientas continuas locales dentro de cada segmento.</li>
</ol>
</section>
<section id="conclusiones-sobre-la-contribución-fundamental" class="level4">
<h4 class="anchored" data-anchor-id="conclusiones-sobre-la-contribución-fundamental">4.1.7. Conclusiones Sobre la Contribución Fundamental</h4>
<p>topologyR transforma la imputación de procedimiento heurístico a <strong>matemáticamente fundamentado</strong> revelando la estructura topológica subyacente que justifica (o prohíbe) las suposiciones de continuidad antes de la aplicación — crucial en contextos de políticas, biomédicos y climáticos.</p>
</section>
<section id="posicionamiento-vs-tda-de-propósito-general" class="level4">
<h4 class="anchored" data-anchor-id="posicionamiento-vs-tda-de-propósito-general">4.1.8. Posicionamiento vs TDA de Propósito General</h4>
<p>Enfoque: series 1D, <strong>β₀</strong> (conectividad), regla de decisión explícita. Complementa pilas PH (Ripser/GUDHI/TDAstats/scikit-TDA) para estructura multi-escala/β superior (sin regla de imputación explícita).</p>
</section>
<section id="limitaciones-y-riesgos" class="level4">
<h4 class="anchored" data-anchor-id="limitaciones-y-riesgos">4.1.9. Limitaciones y Riesgos</h4>
<ol type="1">
<li><p><strong>Sensibilidad de Parámetros</strong> (elección de umbral) → mitigar mediante barridos de factores; aún empírico.</p></li>
<li><p><strong>Muestreo/ruido</strong> puede simular (des)conexión → tratar “conectado ⇒ continuo” como <strong>prima facie</strong>.</p></li>
<li><p><strong>Expresividad</strong> limitada a <strong>β₀</strong>.</p></li>
<li><p><strong>Escalabilidad</strong>: construcciones exhaustivas pueden ser <img src="https://latex.codecogs.com/png.latex?O(n%5E2)">.</p></li>
</ol>
</section>
<section id="conclusiones-globales-y-orientación-práctica" class="level4">
<h4 class="anchored" data-anchor-id="conclusiones-globales-y-orientación-práctica">4.1.10. Conclusiones Globales y Orientación Práctica</h4>
<p>Usar topologyR como una herramienta de <strong>gobernanza pre-modelo</strong> para decisiones binarias de <strong>validez</strong>; complementar con PH para características multi-escala sutiles que no rompen la conectividad global.</p>
</section>
<section id="referencias" class="level4">
<h4 class="anchored" data-anchor-id="referencias">4.1.11. Referencias</h4>
<p>Alvarado, E., Beckelhymer, D., Dorrington, J., Lam, T., Majhi, S., Noory, J., Sánchez Muniz, M., &amp; Strømmen, K. (2025). <em>Detecting the Indian Monsoon using Topological Data Analysis</em> (arXiv:2504.01022). https://arxiv.org/abs/2504.01022</p>
<p>Bauer, U. (2021). Ripser: Efficient computation of Vietoris–Rips persistence barcodes. <em>Journal of Applied and Computational Topology, 5</em>(3), 391–423. https://doi.org/10.1007/s41468-021-00071-5</p>
<p>Chung, M. K., et al.&nbsp;(2023). Unified topological inference for brain networks in temporal dynamics. <em>Frontiers in Neuroscience, 17</em>, 1140289. https://doi.org/10.3389/fnins.2023.1140289</p>
<p>Flammer, M., et al.&nbsp;(2023). Persistent homology-based classification of chaotic multivariate time series: Application to electroencephalograms. <em>SN Computer Science, 4</em>, 396. https://doi.org/10.1007/s42979-023-02396-7</p>
<p>Gidea, M. (2017). <em>Topological data analysis of financial time series</em> (arXiv:1703.04385). https://arxiv.org/abs/1703.04385</p>
<p>Guo, H., et al.&nbsp;(2020). Empirical study of financial crises based on topological data analysis. <em>Physica A: Statistical Mechanics and its Applications, 551</em>, 124198. https://doi.org/10.1016/j.physa.2019.124198</p>
<p>Kang, Y., et al.&nbsp;(2024). High-order brain network feature extraction and characterization via persistent homology. <em>Frontiers in Neuroscience, 18</em>, 1378837. https://doi.org/10.3389/fnins.2024.1378837</p>
<p>Kelley, J. L. (2017). <em>General topology</em> (Dover ed.; original work published 1955). Dover Publications.</p>
<p>Maria, C., Boissonnat, J.-D., Glisse, M., &amp; Yvinec, M. (2014). The GUDHI library: Simplicial complexes and persistent homology. In H. Hong &amp; C. Yap (Eds.), <em>Mathematical Software – ICMS 2014</em> (pp.&nbsp;167–174). Springer. https://doi.org/10.1007/978-3-662-44199-2_28</p>
<p>Otter, N., Porter, M. A., Tillmann, U., Grindrod, P., &amp; Harrington, H. A. (2017). A roadmap for the computation of persistent homology. <em>EPJ Data Science, 6</em>, 17. https://doi.org/10.1140/epjds/s13688-017-0109-5</p>
<p>scikit-TDA. (n.d.). <em>scikit-TDA documentation</em>. https://docs.scikit-tda.org/</p>
<p>Tralie, C., Saul, N., &amp; Bar-On, R. (2018). ripser.py: A lean persistent homology library for Python. <em>Journal of Open Source Software, 3</em>(29), 925. https://doi.org/10.21105/joss.00925</p>
<p>Tymochko, S., et al.&nbsp;(2020). Using persistent homology to quantify a diurnal cycle in tropical cyclone convection. <em>Pattern Recognition Letters, 133</em>, 137–143. https://doi.org/10.1016/j.patrec.2020.02.003</p>
<p>Ver Hoef, L., et al.&nbsp;(2023). A primer on topological data analysis to support image segmentation and feature extraction for environmental science. <em>AI for the Earth Systems, 2</em>(1), e220039. https://doi.org/10.1175/AIES-D-22-0039.1</p>
<p>Wadhwa, R. R., Williamson, D. F. K., Dhawan, A., &amp; Scott, J. G. (2018). TDAstats: R pipeline for computing persistent homology in topological data analysis. <em>Journal of Open Source Software, 3</em>(28), 860. https://doi.org/10.21105/joss.00860</p>
<p>Wang, Z., et al.&nbsp;(2023). Automatic epileptic seizure detection based on persistent homology. <em>Computational and Mathematical Methods in Medicine, 2023</em>, 9165842. https://doi.org/10.1155/2023/9165842</p>
<p>Xu, X., Gao, Y., Zhong, S., Li, P., &amp; Wang, Y. (2021). Topological data analysis as a new tool for EEG processing. <em>Frontiers in Neuroscience, 15</em>, 761703. https://doi.org/10.3389/fnins.2021.761703</p>
</section>
</section>
</section>
<section id="alcance-y-casos-de-uso-típicos" class="level2">
<h2 class="anchored" data-anchor-id="alcance-y-casos-de-uso-típicos">5. Alcance y Casos de Uso Típicos</h2>
<ul>
<li><strong>Series temporales económicas y otras</strong>: regímenes de conectividad, quiebres estructurales.</li>
<li><strong>Datos de señales/biológicos</strong>: grafos de vecindario, verificaciones de cobertura.</li>
<li><strong>Didáctico</strong>: bases/subbases, construcción de topología, puentes grafo↔︎topología.</li>
</ul>
</section>
<section id="principios-de-diseño" class="level2">
<h2 class="anchored" data-anchor-id="principios-de-diseño">6. Principios de Diseño</h2>
<p>Corrección (incluir ∅ y <img src="https://latex.codecogs.com/png.latex?X">; rastrear cobertura), transparencia (funciones paso a paso), explorabilidad (heurísticas rápidas y visuales para selección de umbrales).</p>
</section>
<section id="enfoque-técnico-algoritmos-y-motores-de-conectividad" class="level2">
<h2 class="anchored" data-anchor-id="enfoque-técnico-algoritmos-y-motores-de-conectividad">7. Enfoque Técnico: Algoritmos y Motores de Conectividad</h2>
<p><strong>Algoritmo Central</strong> y <strong>Métodos</strong> (DFS no dirigido; DFS secuencial dirigido; cobertura manual) como se bosqueja en §3 arriba.</p>
<p><strong>Funciones de Conectividad (Internos del Paquete).</strong></p>
<ul>
<li><p><code>is_topology_connected()</code> construye una adyacencia simétrica a partir de co-pertenencia de conjuntos y ejecuta DFS sobre elementos presentes.</p></li>
<li><p><code>is_topology_connected2()</code> dirige aristas a lo largo de elementos ordenados y consecutivos dentro de cada conjunto y hace DFS desde el mínimo.</p></li>
<li><p><code>is_topology_connected_manual()</code> verifica si cada índice original 1..n aparece en al menos un conjunto.</p></li>
</ul>
</section>
<section id="api-de-un-vistazo-inicio-rápido" class="level2">
<h2 class="anchored" data-anchor-id="api-de-un-vistazo-inicio-rápido">8. API de un Vistazo (Inicio Rápido)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(topologyR)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector de ejemplo pequeño</span></span>
<span id="cb2-4">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construir una topología completa y verificar conectividad</span></span>
<span id="cb2-7">topo     <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete_topology</span>(x)</span>
<span id="cb2-8">undirected <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb2-9">directed   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected2</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb2-10">manual     <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected_manual</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exploración de umbrales y barrido de factores</span></span>
<span id="cb2-13">ths <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_thresholds</span>(x)</span>
<span id="cb2-14">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_topology_factors</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>))</span>
<span id="cb2-15">viz <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visualize_topology_thresholds</span>(x)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># visuales opcionales</span></span></code></pre></div></div>
</section>
<section id="heurísticas-de-umbral-y-barrido-de-factores" class="level2">
<h2 class="anchored" data-anchor-id="heurísticas-de-umbral-y-barrido-de-factores">9. Heurísticas de Umbral y Barrido de Factores</h2>
<p>Puedes derivar τ de <strong>diferencias adyacentes media/mediana</strong>, <strong>SD</strong>, <strong>IQR / factor</strong>, o una heurística <strong>similar a DBSCAN</strong>; luego ejecutar un <strong>barrido de factor IQR</strong> (ej., 1, 2, 4, 8, 16) y rastrear <strong>tamaño de base / tamaños de conjuntos</strong> para elegir un régimen estable.</p>
<p>Internamente, el barrido de factores calcula <img src="https://latex.codecogs.com/png.latex?%5Ctau=%5Cmathrm%7BIQR%7D(x)/f">, construye subbases, forma la base (con ∅ y <img src="https://latex.codecogs.com/png.latex?X">), y resume el tamaño de base y tamaños mín/máx de conjuntos por <img src="https://latex.codecogs.com/png.latex?f">.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span>
<span id="cb3-3"></span>
<span id="cb3-4">ths  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_thresholds</span>(x)</span>
<span id="cb3-5">resf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_topology_factors</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(ths)</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(resf)</span></code></pre></div></div>
</section>
<section id="rendimiento-y-escalabilidad" class="level2">
<h2 class="anchored" data-anchor-id="rendimiento-y-escalabilidad">10. Rendimiento y Escalabilidad</h2>
<p>La construcción exacta de vecindarios/base puede crecer como <img src="https://latex.codecogs.com/png.latex?O(n%5E2)">; prefiere umbrales robustos + barridos de factores, y considera submuestreo más allá de <img src="https://latex.codecogs.com/png.latex?n"> moderado. Para diagnósticos de primera pasada en datos muy grandes, usa la verificación de <strong>cobertura manual</strong> y luego refina con DFS dirigido según sea necesario.</p>
</section>
<section id="limitaciones-y-notas-de-validez" class="level2">
<h2 class="anchored" data-anchor-id="limitaciones-y-notas-de-validez">11. Limitaciones y Notas de Validez</h2>
<ul>
<li><p><strong>Sensibilidad de Umbral</strong>: falsas (des)conexiones si τ está mal configurado → mitigar con rejillas, pero mantener juicio del dominio.</p></li>
<li><p><strong>Muestreo/ruido</strong>: el muestreo escaso puede simular desconexiones; las superposiciones ligeras pueden simular conexión → tratar “conectado ⇒ continuo” como <strong>prima facie</strong>, no absoluto.</p></li>
<li><p><strong>Expresividad</strong>: énfasis en <strong>β₀</strong>; características de orden superior requieren pilas PH.</p></li>
<li><p><strong>Suposiciones</strong>: índices secuenciales 1..n; topologías muy grandes pueden ser intensivas en memoria.</p></li>
</ul>
</section>
<section id="ejemplo-completo-decisión-de-imputación" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-completo-decisión-de-imputación">12. Ejemplo Completo: Decisión de Imputación</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(topologyR)</span>
<span id="cb4-2">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AirPassengers)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Predeterminado transparente y robusto para τ y barrido de factores ilustrativo</span></span>
<span id="cb4-5">ths  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_thresholds</span>(x)</span>
<span id="cb4-6">res  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_topology_factors</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8">tau  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IQR</span>(x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb4-9">topo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete_topology</span>(x)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># para n pequeño; de lo contrario usar subbases con umbral</span></span>
<span id="cb4-10"></span>
<span id="cb4-11">is_conn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_topology_connected</span>(topo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>topology)</span>
<span id="cb4-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (is_conn) {</span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Conectado: usando imputación continua global."</span>)</span>
<span id="cb4-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ej., stats::spline(...), kriging global, suavizadores</span></span>
<span id="cb4-15">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Desconectado: imputación por segmentos y modelos de régimen."</span>)</span>
<span id="cb4-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dividir por componentes conectados; imputar/modelar por segmento</span></span>
<span id="cb4-18">}</span></code></pre></div></div>
</section>
<section id="posicionamiento-vs.-tda-de-propósito-general" class="level2">
<h2 class="anchored" data-anchor-id="posicionamiento-vs.-tda-de-propósito-general">13. Posicionamiento vs.&nbsp;TDA de Propósito General</h2>
<p>topologyR es una herramienta pre-modelo <strong>enfocada</strong> y orientada a decisiones para <strong>series 1D</strong> (β₀/conectividad). Para estructura multi-escala/β superior o señales de alerta temprana, complementar con <strong>Ripser/GUDHI/TDAstats/scikit-TDA</strong>.</p>
<p><em>(Fuentes externas clave listadas en la subsección de referencias 4.1.11. de la wiki de la biblioteca)</em></p>
</section>
<section id="instalación" class="level2">
<h2 class="anchored" data-anchor-id="instalación">14. Instalación</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">remotes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IsadoreNabi/topologyR"</span>)</span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># o construcción local</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setwd("/path/to/topologyR"); library(devtools); library(roxygen2); document(); install()</span></span></code></pre></div></div>
</section>
<section id="licencia-y-autor" class="level2">
<h2 class="anchored" data-anchor-id="licencia-y-autor">15. Licencia y Autor</h2>
<p><strong>LICENCIA:</strong> Licencia MIT — ver LICENSE en el repositorio.</p>
<p><strong>AUTOR:</strong> José Mauricio Gómez Julián.</p>


</section>

 ]]></description>
  <category>R</category>
  <category>topología</category>
  <category>series-temporales</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-19-topologyR-esp/</guid>
  <pubDate>Thu, 18 Sep 2025 06:00:00 GMT</pubDate>
</item>
<item>
  <title>BAYESIAN ECONOMIC DISAGGREGATION: A DETERMINISTIC, DIAGNOSTICS-FIRST WORKFLOW</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-17-bayesian-disaggregation/</link>
  <description><![CDATA[ 





<blockquote class="blockquote">
<p>This article summarizes a practical framework for sectoral disaggregation of aggregate indices (e.g., CPI) using deterministic posterior updates and explicit diagnostics. The approach is implemented in the <code>BayesianDisaggregation</code> R package and emphasizes coherence with a sectoral likelihood, numerical/temporal stability, and interpretability.</p>
</blockquote>
<section id="problem-setup" class="level2">
<h2 class="anchored" data-anchor-id="problem-setup">1. Problem Setup</h2>
<p>Consider an aggregate index observed over periods (t = 1,,T). The goal is a sectoral decomposition into (K) components whose shares lie on the unit simplex, with rows that sum to one. The workflow starts from a prior weight matrix (P ^{T K}) (row-stochastic), builds a sectoral likelihood vector (L ^{K-1}), spreads it over time into (L_T ^{T K}), and applies a deterministic update to obtain the posterior (W) (also row-stochastic).</p>
</section>
<section id="constructing-the-sectoral-likelihood-l" class="level2">
<h2 class="anchored" data-anchor-id="constructing-the-sectoral-likelihood-l">2. Constructing the Sectoral Likelihood (L)</h2>
<p><strong>PC1 Salience.</strong> Columns of (P) are centered over time; an SVD/PCA is computed on the centered matrix. The first right singular vector’s absolute entries are normalized to obtain a non-negative (L). When PC1 is degenerate, a fallback uses column means of (P) (renormalized). Attributes record loadings, explained variance and the fallback flag.</p>
<p><strong>Temporal Spreading.</strong> A non-negative profile (w_t) spreads (L) into (L_T) by row-normalization. Built-in patterns include <code>constant</code>, <code>recent</code> (linearly increasing in (t)), <code>linear</code>, and <code>bell</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From the package:</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># L  &lt;- compute_L_from_P(P)</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LT &lt;- spread_likelihood(L, T_periods = nrow(P), pattern = "recent")</span></span></code></pre></div></div>
</section>
<section id="deterministic-posterior-updates-mcmc-free" class="level2">
<h2 class="anchored" data-anchor-id="deterministic-posterior-updates-mcmc-free">2. Deterministic Posterior Updates (MCMC-Free)</h2>
<p>Four options are provided:</p>
<ul>
<li><strong>Weighted Average:</strong> <img src="https://latex.codecogs.com/png.latex?W%20=%20%5Ctext%7Bnorm1%7D%5C%7B%5Clambda%20P%20+%20(1-%5Clambda)%20L_T%5C%7D">.</li>
<li><strong>Multiplicative:</strong> <img src="https://latex.codecogs.com/png.latex?W%20=%20%5Ctext%7Bnorm1%7D%5C%7BP%20%5Codot%20L_T%5C%7D">.</li>
<li><strong>Dirichlet Mean:</strong> analytic conjugacy with γ&gt;0; smaller γ sharpens the posterior mean.</li>
<li><strong>Adaptive Mixing:</strong> sector-wise mixing scales by prior volatility.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_weighted(P, LT, lambda = 0.7)</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_multiplicative(P, LT)</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_dirichlet(P, LT, gamma = 0.1)</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_adaptive(P, LT)</span></span></code></pre></div></div>
<p>All updates keep rows on the simplex by construction.</p>
</section>
<section id="diagnostics-coherence-stability-interpretability" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics-coherence-stability-interpretability">3. Diagnostics: Coherence, Stability, Interpretability</h2>
<ul>
<li><strong>Coherence:</strong> correlation gain of the posterior temporal mean <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bw%7D"> vs.&nbsp;prior <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bp%7D"> with respect to <img src="https://latex.codecogs.com/png.latex?L">, bounded in <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> via a linear scale.</li>
<li><strong>Numerical &amp; Temporal Stability:</strong> exponential penalty for row-sum deviation/negatives plus a smoothness score based on average absolute differences over time; combined into a composite stability score.</li>
<li><strong>Interpretability:</strong> preservation of sectoral structure (corr<img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bp%7D,%5Cbar%7Bw%7D)">) and plausibility of average relative shifts (90th percentile). Implementation is exposed as <code>coherence_score()</code>, <code>numerical_stability_exp()</code>, <code>temporal_stability()</code>, <code>stability_composite()</code>, and <code>interpretability_score()</code>.</li>
</ul>
</section>
<section id="end-to-end-api" class="level2">
<h2 class="anchored" data-anchor-id="end-to-end-api">4. End-To-End API</h2>
<p>A convenience wrapper orchestrates I/O, likelihood construction, posterior, metrics, and exports.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bayesian_disaggregate(</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   path_cpi, path_weights,</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   method = c("weighted","multiplicative","dirichlet","adaptive"),</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   lambda = 0.7, gamma = 0.1,</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   coh_mult = 3.0, coh_const = 0.5,</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   stab_a = 1000, stab_b = 10, stab_kappa = 50,</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   likelihood_pattern = "recent"</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
<p>Outputs include a tidy posterior <img src="https://latex.codecogs.com/png.latex?W">, diagnostics, optional Excel exports, and quick plots.</p>
</section>
<section id="synthetic-and-reproducible-demo" class="level2">
<h2 class="anchored" data-anchor-id="synthetic-and-reproducible-demo">5. Synthetic and Reproducible Demo</h2>
<p>The following chunk synthesizes a small prior, derives <img src="https://latex.codecogs.com/png.latex?L"> and <img src="https://latex.codecogs.com/png.latex?L_T">, compares posteriors, and computes key metrics. It renders quickly on any machine.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb4-2">T <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>; K <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb4-3">P <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(T<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>K), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> T); P <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> P <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(P)</span>
<span id="cb4-4"></span>
<span id="cb4-5">L  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_L_from_P</span>(P)                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PCA/SVD with robust fallback</span></span>
<span id="cb4-6">LT <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_likelihood</span>(L, T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recent"</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8">W_adapt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_adaptive</span>(P, LT)            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># recommended when sector volatilities differ</span></span>
<span id="cb4-9">coh  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coherence_score</span>(P, W_adapt, L)</span>
<span id="cb4-10">stab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stability_composite</span>(W_adapt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kappa =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb4-11">intr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interpretability_score</span>(P, W_adapt)</span>
<span id="cb4-12"></span>
<span id="cb4-13">eff  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># heuristic efficiency placeholder</span></span>
<span id="cb4-14">comp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>coh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>stab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>intr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>eff</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coherence=</span>coh, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stability=</span>stab, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interpretability=</span>intr,</span>
<span id="cb4-17">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">efficiency=</span>eff, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">composite=</span>comp), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div></div>
</div>
<p>The demo mirrors the manual’s quick example and target ranges.</p>
</section>
<section id="real-data-pipeline-disabled-for-speed" class="level2">
<h2 class="anchored" data-anchor-id="real-data-pipeline-disabled-for-speed">6. Real-Data Pipeline (Disabled for Speed)</h2>
<p>Switch <code>eval: true</code> after setting paths to local Excel files. This runs the compact grid, re-executes the best configuration, and writes a single Excel with all artifacts.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example paths (Windows: use forward slashes or raw strings)</span></span>
<span id="cb5-2">path_cpi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E:/Carpeta de Estudio/.../CPI.xlsx"</span></span>
<span id="cb5-3">path_w   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E:/Carpeta de Estudio/.../PESOS VAB.xlsx"</span></span>
<span id="cb5-4"></span>
<span id="cb5-5">base_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bayesian_disaggregate</span>(</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path_cpi =</span> path_cpi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path_weights =</span> path_w,</span>
<span id="cb5-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adaptive"</span>,</span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb5-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coh_mult =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coh_const =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stab_a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stab_b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stab_kappa =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb5-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">likelihood_pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recent"</span></span>
<span id="cb5-12">)</span>
<span id="cb5-13"></span>
<span id="cb5-14">base_res<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>metrics</span></code></pre></div></div>
</div>
<p>A minimal grid search and one-file Excel export can be added following the package helpers.</p>
</section>
<section id="reading-the-visuals" class="level2">
<h2 class="anchored" data-anchor-id="reading-the-visuals">7. Reading the Visuals</h2>
<p>A posterior heatmap reveals sectoral persistence and smoothness over time; top-sectors line plots emphasize dominant components; the sectoral-CPI sheet shows <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D_%7Bt,k%7D%20=%20%5Ctext%7BCPI%7D_t%20%5Ctimes%20W_%7Bt,k%7D">, enabling a decomposed view of the aggregate series.</p>
</section>
<section id="practical-defaults" class="level2">
<h2 class="anchored" data-anchor-id="practical-defaults">8. Practical Defaults</h2>
<p>Adaptive mixing is robust under heterogeneous prior volatility; otherwise the weighted rule with <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cin%20%5B0.7,%200.9%5D"> often performs strongly. Coherence scaling <img src="https://latex.codecogs.com/png.latex?(%5Ctexttt%7Bmult%7D=3.0,%5C%20%5Ctexttt%7Bconst%7D=0.5)"> yields a bounded, interpretable 0–1 score. The exponential numerical penalty is intentionally sharp to enforce row-stochasticity in automated runs.</p>
</section>
<section id="key-innovation" class="level1">
<h1>9. Key Innovation</h1>
<p><em>This package represents a methodological contribution to econometrics and data science, providing the first analytical solution to the structure transfer problem with uncertain intermediaries.</em></p>
<p>The package’s breakthrough lies in recognizing that PCA on temporally-centered disaggregation weights yields exactly the likelihood signal needed for Bayesian updating. This enables: - <strong>Formal uncertainty quantification</strong> rather than ad-hoc treatment - <strong>Analytical solutions</strong> for tractable sample sizes - <strong>Transparent propagation</strong> of proxy uncertainty to final results</p>
<section id="summary-of-related-methods-and-where-this-package-fits" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-related-methods-and-where-this-package-fits">9.1. Summary of Related Methods and Where This package Fits</h2>
<p><strong>Problem.</strong> You often want to compare an <strong>aggregate</strong> series <img src="https://latex.codecogs.com/png.latex?X_t"> (e.g., CPI) with a <strong>disaggregated</strong> series <img src="https://latex.codecogs.com/png.latex?Y_%7Bt,k%7D"> across sectors <img src="https://latex.codecogs.com/png.latex?k">, but only have an <strong>imperfect intermediary</strong> <img src="https://latex.codecogs.com/png.latex?Z_%7Bt,k%7D"> that approximates the cross-sectional structure (e.g., sectoral value added). The conceptual challenge is <strong>transferring structure</strong> from <img src="https://latex.codecogs.com/png.latex?Z"> to disaggregate <img src="https://latex.codecogs.com/png.latex?X">, while <strong>honestly accounting for uncertainty</strong> in <img src="https://latex.codecogs.com/png.latex?Z">.</p>
<p><strong>What this package does.</strong> The package treats <img src="https://latex.codecogs.com/png.latex?Z"> as a <strong>Bayesian prior</strong> over sectoral weights <img src="https://latex.codecogs.com/png.latex?P_%7Bt,k%7D"> (rows on the probability simplex), extracts a <strong>low-dimensional temporal signal</strong> via <strong>PCA computed by SVD</strong> on the time-centered matrix <img src="https://latex.codecogs.com/png.latex?Z">, and uses that signal as an <strong>analytical likelihood</strong> to obtain a <strong>closed-form posterior</strong> <img src="https://latex.codecogs.com/png.latex?W_%7Bt,k%7D"> for the weights. The updated weights then disaggregate <img src="https://latex.codecogs.com/png.latex?X_t"> into <img src="https://latex.codecogs.com/png.latex?X_%7Bt,k%7D=W_%7Bt,k%7D%5C,X_t">. This is entirely <strong>MCMC-free</strong> and computationally light. Conceptually, it is a <strong>structure-transfer</strong> method with an <strong>uncertain intermediary</strong> and an <strong>analytical update</strong>.</p>
<p><strong>What we did <em>not</em> find in the literature.</strong> We did not find a prior, named methodology that (i) takes an <strong>uncertain structural intermediary</strong> <img src="https://latex.codecogs.com/png.latex?Z">, (ii) <strong>derives a temporal likelihood</strong> from <strong>PCA/SVD</strong> of <img src="https://latex.codecogs.com/png.latex?Z">, and (iii) performs an <strong>analytical Bayesian update</strong> to produce posterior disaggregation weights that remain <strong>row-stochastic</strong> and are used to disaggregate an unrelated aggregate <img src="https://latex.codecogs.com/png.latex?X_t">. There are adjacent traditions, but each misses at least one of these pieces:</p>
<ul>
<li><strong>Biproportional balancing / RAS / IPF.</strong> Classic RAS adjusts a matrix to match new margins by <strong>multiplying rows/columns</strong> iteratively (Deming &amp; Stephan, 1940, pp.&nbsp;28–29; overviews referencing Bacharach, 1970). It <strong>doesn’t</strong> construct a likelihood from PCA/SVD nor deliver a <strong>probabilistic posterior on the simplex</strong> for use as disaggregation weights. It’s a deterministic reconciliation method for totals, not a Bayesian structure-transfer with an uncertain intermediary.</li>
<li><strong>Temporal disaggregation</strong> (Denton, Chow–Lin, Fernández). These methods distribute <strong>low-frequency aggregates</strong> into higher frequency using a related indicator series, via smoothness/BLU estimators (Eurostat, 2013, pp.&nbsp;79–98; see Denton-type formulations; Chow–Lin and Fernández are discussed there). They <strong>do not</strong> address <strong>cross-sectional</strong> disaggregation with <strong>simplex-valued weights</strong> nor use PCA-derived likelihoods.</li>
<li><strong>Forecast reconciliation for hierarchies</strong> (e.g., MinT). This reconciles <strong>inconsistent forecasts across aggregation trees</strong> by projecting onto a coherent subspace (Wickramasuriya et al., 2019, pp.&nbsp;1–3). It is <em>forecast</em>-centric and linear-algebraic—not a Bayesian update for <strong>compositional</strong> weights with PCA-likelihoods.</li>
<li><strong>Compositional/Bayesian state-space models</strong> exist (e.g., Dirichlet evolutions), but we did not find an <strong>analytical</strong> 1-step update that (a) builds its <strong>likelihood from PCA/SVD of</strong> <img src="https://latex.codecogs.com/png.latex?Z"> and (b) outputs <strong>posterior weights</strong> to <strong>disaggregate a different aggregate series</strong> <img src="https://latex.codecogs.com/png.latex?X_t">.</li>
</ul>
<p><strong>Takeaway.</strong> To our knowledge, the package provides a <strong>new, analytical</strong> approach to the “structure transfer with uncertain intermediary” problem in the specific setting of <strong>time-varying, simplex-valued weights</strong>: it uses <strong>PCA via SVD</strong> on <img src="https://latex.codecogs.com/png.latex?Z"> to define a <strong>temporal likelihood</strong>, and then performs a <strong>closed-form Bayesian update</strong> to posterior weights that can immediately <strong>disaggregate</strong> <img src="https://latex.codecogs.com/png.latex?X_t">. That makes it distinct from RAS/IPF balancing, from temporal-frequency disaggregation (Denton/Chow–Lin/Fernández), and from hierarchical forecast reconciliation.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">9.2. References</h2>
<p>Deming, W. E., &amp; Stephan, F. F. (1940). On a least squares adjustment of a sampled frequency table when the expected marginal totals are known. <em>The Annals of Mathematical Statistics, 11</em>(4), 427–444. <a href="https://doi.org/10.1214/aoms/1177731829" class="uri">https://doi.org/10.1214/aoms/1177731829</a> (see method description on pp.&nbsp;428–430 for the iterative proportional fitting idea). ([<a href="https://apps.bea.gov/scb/pdf/2008/05%20May/0508_methods.pdf?utm_source=chatgpt.com">apps.bea.gov</a>][1])</p>
<p>Eurostat. (2013). <em>Handbook on quarterly national accounts</em> (2013 edition). Publications Office of the European Union. (See Chapter “Benchmarking and temporal disaggregation,” esp.&nbsp;the Denton formulation and BLU approaches, pp.&nbsp;79–98.)</p>
<p>International Labour Organization (ILO), International Monetary Fund (IMF), Organisation for Economic Co-operation and Development (OECD), Eurostat, United Nations Economic Commission for Europe (UNECE), &amp; The World Bank. (2020). <em>Consumer Price Index Manual: Concepts and Methods</em>. IMF. (Aggregation structure and weighting practices are explained throughout; see e.g.&nbsp;Ch. 3 on index number theory and aggregation). ([<a href="https://www.scribd.com/document/915498814/Input-Output-Analysis-Foundations-and-Extensions-2nd-edition-Ronald-E-Miller-pdf-version?utm_source=chatgpt.com">Scribd</a>][2])</p>
<p>Wickramasuriya, S. L., Athanasopoulos, G., &amp; Hyndman, R. J. (2019). Optimal forecast reconciliation for hierarchical and grouped time series through trace minimization. <em>Statistica Sinica, 30</em>(4), 1555–1586. (Preprint version available as arXiv:1805.07245; see Sections 1–2 for the reconciliation setup.) ([<a href="https://www.scribd.com/document/794344468/Book4-SVD?utm_source=chatgpt.com">Scribd</a>][3])</p>
<section id="notes-on-scope-and-claims" class="level3">
<h3 class="anchored" data-anchor-id="notes-on-scope-and-claims">9.2.1. Notes on Scope and Claims</h3>
<ul>
<li><strong>On novelty.</strong> Because adjacent areas are vast, we phrase novelty as <strong>“to our knowledge, we did not find …”</strong> rather than an absolute first. The distinctive combination here is: <strong>(i)</strong> uncertain <strong>intermediary</strong> <img src="https://latex.codecogs.com/png.latex?Z"> treated as a <strong>prior on the simplex</strong>, <strong>(ii)</strong> <strong>likelihood built from PCA via SVD</strong> on time-centered <img src="https://latex.codecogs.com/png.latex?Z">, and <strong>(iii)</strong> <strong>analytical (non-MCMC) posterior</strong> used to <strong>disaggregate an unrelated aggregate</strong> <img src="https://latex.codecogs.com/png.latex?X_t">.</li>
<li><strong>On CPI examples.</strong> Public CPI databases (e.g., headline CPI and coarse categories) typically lack rich sectoral disaggregation tied to national accounts—hence the need to <strong>transfer structure</strong> from a proxy like <img src="https://latex.codecogs.com/png.latex?Z"> (e.g., value added) rather than rely on directly observed <img src="https://latex.codecogs.com/png.latex?X_%7Bt,k%7D">. The CPI Manual (2020) documents aggregation frameworks and weights at a conceptual level but does not provide a ready-made cross-sectional mapping suited to your use case (see CPI Manual, 2020). [1]: <a href="https://apps.bea.gov/scb/pdf/2008/05%20May/0508_methods.pdf?utm_source=chatgpt.com">https://apps.bea.gov/scb/pdf/2008/05%20May/0508_methods.pd</a>f “An Empirical Review of Methods for Temporal Distribution …” [2]: <a href="https://www.scribd.com/document/915498814/Input-Output-Analysis-Foundations-and-Extensions-2nd-edition-Ronald-E-Miller-pdf-version?utm_source=chatgpt.com">https://www.scribd.com/document/915498814/Input-Output-Analysis-Foundations-and-Extensions-2nd-edition-Ronald-E-Miller-pdf-version</a> “Input Output Analysis Foundations and Extensions 2nd” [3]: <a href="https://www.scribd.com/document/794344468/Book4-SVD?utm_source=chatgpt.com">https://www.scribd.com/document/794344468/Book4-SVD</a> “Book4 SVD | PDF | Principal Component Analysis”</li>
</ul>
</section>
</section>
<section id="economic-applications" class="level2">
<h2 class="anchored" data-anchor-id="economic-applications">9.3. Economic Applications</h2>
<section id="disaggregating-consumer-price-index" class="level3">
<h3 class="anchored" data-anchor-id="disaggregating-consumer-price-index">9.3.1. Disaggregating Consumer Price Index</h3>
<p>This package enables analyses that were previously impossible:</p>
<ul>
<li><p><strong>Which sectors are truly driving inflation?</strong> Decompose CPI by economic activity to identify inflation sources</p></li>
<li><p><strong>How do price shocks differentially affect industries?</strong> Understand sector-specific impacts of monetary policy</p></li>
<li><p><strong>What are the real sectoral price dynamics?</strong> Track inflation patterns at the industry level</p></li>
</ul>
<p>These are questions policymakers need answered but couldn’t address with existing tools. No traditional methods exist for disaggregating CPI by economic sector because the mapping between consumer prices and productive sectors is inherently uncertain.</p>
</section>
</section>
<section id="applications-beyond-economics" class="level2">
<h2 class="anchored" data-anchor-id="applications-beyond-economics">9.4. Applications Beyond Economics</h2>
<p>The framework generalizes to any domain with the <strong>structure transfer problem</strong>:</p>
<section id="neuroscience" class="level3">
<h3 class="anchored" data-anchor-id="neuroscience">9.4.1. Neuroscience</h3>
<p>Relate global brain activity (aggregated) to specific cognitive functions (disaggregated) using imperfect anatomical mappings. Understand which brain regions contribute to observed EEG/MEG signals while accounting for spatial uncertainty.</p>
</section>
<section id="climate-science" class="level3">
<h3 class="anchored" data-anchor-id="climate-science">9.4.2. Climate Science&nbsp;</h3>
<p>Distribute global climate projections to regional levels using uncertain downscaling models. Project temperature/precipitation changes from coarse climate models to local watersheds while quantifying projection uncertainty.</p>
</section>
<section id="epidemiology" class="level3">
<h3 class="anchored" data-anchor-id="epidemiology">9.4.3. Epidemiology</h3>
<p>Allocate national mortality rates to specific subpopulations using imperfect demographic proxies. Decompose country-level disease burden to demographic groups when direct measurements are unavailable.</p>
</section>
<section id="signal-processing" class="level3">
<h3 class="anchored" data-anchor-id="signal-processing">9.4.4. Signal Processing</h3>
<p>Reconstruct high-frequency components from compressed signals using approximate dictionaries. Recover detailed structure from aggregated measurements in compressed sensing applications.</p>
</section>
<section id="machine-learning" class="level3">
<h3 class="anchored" data-anchor-id="machine-learning">9.4.5. Machine Learning</h3>
<p>Transfer knowledge from source domains to granular target domains through noisy intermediate representations. Apply domain adaptation when the mapping between domains is uncertain.</p>
</section>
</section>
<section id="real-world-impact" class="level2">
<h2 class="anchored" data-anchor-id="real-world-impact">9.5. Real-World Impact</h2>
<p>By providing the first principled method for CPI disaggregation, this package opens new analytical frontiers:</p>
<ul>
<li><p><strong>Central banks</strong> can identify sector-specific inflation drivers for targeted policy</p></li>
<li><p><strong>Researchers</strong> can study differential price transmission across industries</p></li>
<li><p><strong>Analysts</strong> can decompose aggregate shocks into sectoral components</p></li>
<li><p><strong>Policymakers</strong> can design interventions based on granular inflation dynamics</p></li>
</ul>
<p>The framework’s generality means similar breakthroughs are possible wherever the <strong>structure transfer problem</strong> appears—from neuroscience to climate modeling.</p>


</section>
</section>

 ]]></description>
  <category>R</category>
  <category>packages</category>
  <category>Bayesian</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-17-bayesian-disaggregation/</guid>
  <pubDate>Wed, 17 Sep 2025 06:00:00 GMT</pubDate>
</item>
<item>
  <title>DESAGREGACIÓN ECONÓMICA BAYESIANA: UN FLUJO DETERMINISTA ORIENTADO A DIAGNÓSTICOS</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-17-desagregacion-bayesiana/</link>
  <description><![CDATA[ 





<blockquote class="blockquote">
<p>Se presenta un marco práctico para la desagregación sectorial de índices agregados (p.&nbsp;ej., IPC) mediante actualizaciones deterministas del posterior y diagnósticos explícitos. La implementación corresponde al paquete <code>BayesianDisaggregation</code> de R y prioriza la coherencia con una verosimilitud sectorial, la estabilidad numérica/temporal y la interpretabilidad.</p>
</blockquote>
<section id="planteamiento-del-problema" class="level2">
<h2 class="anchored" data-anchor-id="planteamiento-del-problema">1. Planteamiento del problema</h2>
<p>Sea un índice agregado observado en periodos <img src="https://latex.codecogs.com/png.latex?t%20=%201,%5Cdots,T">. El objetivo es una descomposición sectorial en <img src="https://latex.codecogs.com/png.latex?K"> componentes cuyas proporciones yacen en el simplex unitario, con filas que suman uno. El flujo parte de una matriz de pesos previa <img src="https://latex.codecogs.com/png.latex?P%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BT%20%5Ctimes%20K%7D"> (estocástica por filas), construye un vector de verosimilitud sectorial <img src="https://latex.codecogs.com/png.latex?L%20%5Cin%20%5CDelta%5E%7BK-1%7D">, lo propaga en el tiempo hacia <img src="https://latex.codecogs.com/png.latex?L_T%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BT%20%5Ctimes%20K%7D"> y aplica una actualización determinista para obtener el posterior <img src="https://latex.codecogs.com/png.latex?W"> (también estocástico por filas).</p>
</section>
<section id="construcción-de-la-verosimilitud-sectorial-l" class="level2">
<h2 class="anchored" data-anchor-id="construcción-de-la-verosimilitud-sectorial-l">2. Construcción de la verosimilitud sectorial <img src="https://latex.codecogs.com/png.latex?L"></h2>
<p><strong>Saliencia de la PC1.</strong> Se centran en el tiempo las columnas de <img src="https://latex.codecogs.com/png.latex?P">; se calcula SVD/PCA sobre la matriz centrada. Las entradas absolutas del primer vector singular derecho se normalizan para obtener un <img src="https://latex.codecogs.com/png.latex?L"> no negativo. Cuando la PC1 es degenerada, se recurre a un respaldo basado en medias de columna (renormalizadas). Se registran como atributos las cargas, la varianza explicada y un indicador del respaldo.</p>
<p><strong>Propagación temporal.</strong> Un perfil no negativo <img src="https://latex.codecogs.com/png.latex?w_t"> expande <img src="https://latex.codecogs.com/png.latex?L"> hacia <img src="https://latex.codecogs.com/png.latex?L_T"> mediante normalización por filas. Existen patrones incorporados como <code>constant</code>, <code>recent</code> (creciente en <img src="https://latex.codecogs.com/png.latex?t">), <code>linear</code> y <code>bell</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From the package:</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># L  &lt;- compute_L_from_P(P)</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LT &lt;- spread_likelihood(L, T_periods = nrow(P), pattern = "recent")</span></span></code></pre></div></div>
</section>
<section id="actualizaciones-deterministas-del-posterior-sin-mcmc" class="level2">
<h2 class="anchored" data-anchor-id="actualizaciones-deterministas-del-posterior-sin-mcmc">2. Actualizaciones deterministas del posterior (sin MCMC)</h2>
<p>Se ofrecen cuatro opciones:</p>
<ul>
<li><strong>Promedio ponderado:</strong> <img src="https://latex.codecogs.com/png.latex?W%20=%20%5Cmathrm%7Bnorm1%7D%5C%7B%5Clambda%20P%20+%20(1-%5Clambda)%20L_T%5C%7D">.</li>
<li><strong>Multiplicativa:</strong> <img src="https://latex.codecogs.com/png.latex?W%20=%20%5Cmathrm%7Bnorm1%7D%5C%7BP%20%5Codot%20L_T%5C%7D">.</li>
<li><strong>Media Dirichlet:</strong> conjugación analítica con <img src="https://latex.codecogs.com/png.latex?%5Cgamma%3E0">; <img src="https://latex.codecogs.com/png.latex?%5Cgamma"> menor agudiza la media posterior.</li>
<li><strong>Mezcla adaptativa:</strong> la mezcla por sector escala con la volatilidad previa.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_weighted(P, LT, lambda = 0.7)</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_multiplicative(P, LT)</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_dirichlet(P, LT, gamma = 0.1)</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># posterior_adaptive(P, LT)</span></span></code></pre></div></div>
<p>Todas las actualizaciones preservan la suma-unidad por fila por construcción.</p>
</section>
<section id="diagnósticos-coherencia-estabilidad-interpretabilidad" class="level2">
<h2 class="anchored" data-anchor-id="diagnósticos-coherencia-estabilidad-interpretabilidad">3. Diagnósticos: coherencia, estabilidad, interpretabilidad</h2>
<ul>
<li><strong>Coherencia:</strong> ganancia de correlación de la media temporal posterior <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bw%7D"> frente a la previa <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bp%7D"> con respecto a <img src="https://latex.codecogs.com/png.latex?L">, acotada en <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> mediante un reescalamiento lineal.</li>
<li><strong>Estabilidad numérica y temporal:</strong> penalización exponencial por desviaciones de suma de fila/negativos más una medida de suavidad basada en diferencias absolutas promedio en el tiempo; se combinan en una puntuación compuesta.</li>
<li><strong>Interpretabilidad:</strong> preservación de la estructura sectorial <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7Bcorr%7D(%5Cbar%7Bp%7D,%5Cbar%7Bw%7D)"> y plausibilidad de los cambios relativos medios (percentil 90).</li>
</ul>
<p>Las funciones expuestas incluyen <code>coherence_score()</code>, <code>numerical_stability_exp()</code>, <code>temporal_stability()</code>, <code>stability_composite()</code> e <code>interpretability_score()</code>.</p>
</section>
<section id="api-end-to-end" class="level2">
<h2 class="anchored" data-anchor-id="api-end-to-end">4. API end-to-end</h2>
<p>Un envoltorio organiza E/S, construcción de <img src="https://latex.codecogs.com/png.latex?L">, posterior, métricas y exportaciones.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bayesian_disaggregate(</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   path_cpi, path_weights,</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   method = c("weighted","multiplicative","dirichlet","adaptive"),</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   lambda = 0.7, gamma = 0.1,</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   coh_mult = 3.0, coh_const = 0.5,</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   stab_a = 1000, stab_b = 10, stab_kappa = 50,</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   likelihood_pattern = "recent"</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
<p>La salida incluye <img src="https://latex.codecogs.com/png.latex?W"> en formato “tidy”, diagnósticos, exportaciones opcionales a Excel y gráficos rápidos.</p>
</section>
<section id="demostración-sintética-y-reproducible" class="level2">
<h2 class="anchored" data-anchor-id="demostración-sintética-y-reproducible">5. Demostración sintética y reproducible</h2>
<p>El siguiente bloque sintetiza un previo pequeño, deriva <img src="https://latex.codecogs.com/png.latex?L"> y <img src="https://latex.codecogs.com/png.latex?L_T">, compara posteriores y calcula métricas clave. Renderiza con rapidez en equipos típicos.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb4-2">T <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>; K <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb4-3">P <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(T<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>K), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> T); P <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> P <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(P)</span>
<span id="cb4-4"></span>
<span id="cb4-5">L  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_L_from_P</span>(P)                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PCA/SVD con respaldo robusto</span></span>
<span id="cb4-6">LT <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spread_likelihood</span>(L, T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recent"</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8">W_adapt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">posterior_adaptive</span>(P, LT)            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># recomendado con volatilidades sectoriales heterogéneas</span></span>
<span id="cb4-9">coh  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coherence_score</span>(P, W_adapt, L)</span>
<span id="cb4-10">stab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stability_composite</span>(W_adapt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kappa =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb4-11">intr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interpretability_score</span>(P, W_adapt)</span>
<span id="cb4-12"></span>
<span id="cb4-13">eff  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span></span>
<span id="cb4-14">comp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.30</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>coh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>stab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>intr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>eff</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coherence=</span>coh, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stability=</span>stab, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interpretability=</span>intr,</span>
<span id="cb4-17">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">efficiency=</span>eff, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">composite=</span>comp), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div></div>
</div>
<p>La demostración replica el ejemplo rápido del manual y sus rangos objetivo.</p>
</section>
<section id="flujo-con-datos-reales-desactivado-por-velocidad" class="level2">
<h2 class="anchored" data-anchor-id="flujo-con-datos-reales-desactivado-por-velocidad">6. Flujo con datos reales (desactivado por velocidad)</h2>
<p>Activar <code>eval: true</code> tras definir rutas a archivos locales de Excel. Se ejecuta una cuadrícula compacta, se re-ejecuta la mejor configuración y se escribe un único Excel con todos los artefactos.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rutas de ejemplo (Windows: usar barras normales o cadenas crudas)</span></span>
<span id="cb5-2">path_cpi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E:/Carpeta de Estudio/.../CPI.xlsx"</span></span>
<span id="cb5-3">path_w   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E:/Carpeta de Estudio/.../PESOS VAB.xlsx"</span></span>
<span id="cb5-4"></span>
<span id="cb5-5">base_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bayesian_disaggregate</span>(</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path_cpi =</span> path_cpi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path_weights =</span> path_w,</span>
<span id="cb5-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adaptive"</span>,</span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lambda =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gamma =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb5-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coh_mult =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coh_const =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stab_a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stab_b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stab_kappa =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb5-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">likelihood_pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recent"</span></span>
<span id="cb5-12">)</span>
<span id="cb5-13"></span>
<span id="cb5-14">base_res<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>metrics</span></code></pre></div></div>
</div>
<p>Puede añadirse una búsqueda en rejilla mínima y la exportación a Excel en un solo archivo siguiendo los auxiliares del paquete.</p>
</section>
<section id="lectura-de-los-gráficos" class="level2">
<h2 class="anchored" data-anchor-id="lectura-de-los-gráficos">7. Lectura de los gráficos</h2>
<p>El mapa de calor del posterior muestra persistencia y suavidad sectorial en el tiempo; las líneas de sectores dominantes enfatizan componentes principales; la hoja “sectoral-CPI” presenta <img src="https://latex.codecogs.com/png.latex?%5Chat%7BY%7D_%7Bt,k%7D%20=%20%5Cmathrm%7BCPI%7D_t%20%5Ctimes%20W_%7Bt,k%7D">, permitiendo una vista desagregada de la serie agregada.</p>
</section>
<section id="parámetros-prácticos-por-defecto" class="level2">
<h2 class="anchored" data-anchor-id="parámetros-prácticos-por-defecto">8. Parámetros prácticos por defecto</h2>
<p>La mezcla adaptativa es robusta con volatilidad previa heterogénea; en caso contrario, la regla ponderada con <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cin%20%5B0.7,%200.9%5D"> suele funcionar bien. El escalado de coherencia <img src="https://latex.codecogs.com/png.latex?(%5Ctexttt%7Bmult%7D=3.0,%5C%20%5Ctexttt%7Bconst%7D=0.5)"> produce una puntuación 0–1 interpretable. La penalización numérica exponencial es deliberadamente estricta para hacer cumplir estocasticidad por filas en ejecuciones automáticas.</p>
</section>
<section id="innovación-clave" class="level2">
<h2 class="anchored" data-anchor-id="innovación-clave">9. Innovación clave</h2>
<p>Se aporta, hasta donde se tiene conocimiento, una solución analítica al problema de <strong>transferencia de estructura con intermediario incierto</strong>: la PCA sobre pesos de desagregación centrados en el tiempo provee la señal de verosimilitud para una actualización bayesiana cerrada en el simplex, habilitando la desagregación sectorial inmediata de una serie agregada no relacionada.</p>
</section>
<section id="métodos-relacionados-y-posicionamiento" class="level2">
<h2 class="anchored" data-anchor-id="métodos-relacionados-y-posicionamiento">9.1. Métodos relacionados y posicionamiento</h2>
<p><strong>Problema.</strong> Con frecuencia se requiere comparar una serie <strong>agregada</strong> <img src="https://latex.codecogs.com/png.latex?X_t"> (p.&nbsp;ej., IPC) con una serie <strong>desagregada</strong> <img src="https://latex.codecogs.com/png.latex?Y_%7Bt,k%7D"> en sectores <img src="https://latex.codecogs.com/png.latex?k">, contando solo con un <strong>intermediario imperfecto</strong> <img src="https://latex.codecogs.com/png.latex?Z_%7Bt,k%7D"> que aproxima la estructura transversal (p.&nbsp;ej., valor agregado sectorial). El reto conceptual consiste en <strong>transferir estructura</strong> desde <img src="https://latex.codecogs.com/png.latex?Z"> para desagregar <img src="https://latex.codecogs.com/png.latex?X">, <strong>reconociendo la incertidumbre</strong> de <img src="https://latex.codecogs.com/png.latex?Z">.</p>
<p><strong>Aporte del paquete.</strong> <img src="https://latex.codecogs.com/png.latex?Z"> se trata como <strong>previo bayesiano</strong> sobre pesos sectoriales <img src="https://latex.codecogs.com/png.latex?P_%7Bt,k%7D"> (filas en el simplex); se extrae una <strong>señal temporal de baja dimensión</strong> mediante <strong>PCA por SVD</strong> en la matriz <img src="https://latex.codecogs.com/png.latex?Z"> centrada en el tiempo, y se utiliza dicha señal como <strong>verosimilitud analítica</strong> para obtener un <strong>posterior en forma cerrada</strong> <img src="https://latex.codecogs.com/png.latex?W_%7Bt,k%7D">. Luego, <img src="https://latex.codecogs.com/png.latex?X_t"> se desagrega como <img src="https://latex.codecogs.com/png.latex?X_%7Bt,k%7D=W_%7Bt,k%7D%5C,X_t">. Todo el proceso es <strong>sin MCMC</strong> y computacionalmente ligero.</p>
<p><strong>Lo que no se identificó en la literatura.</strong> No se encontró una metodología nombrada que: (i) parta de un <strong>intermediario estructural incierto</strong> <img src="https://latex.codecogs.com/png.latex?Z">, (ii) <strong>derive una verosimilitud temporal</strong> desde <strong>PCA/SVD</strong> de <img src="https://latex.codecogs.com/png.latex?Z">, y (iii) ejecute una <strong>actualización bayesiana analítica</strong> que produzca pesos posteriores de desagregación <strong>estocásticos por filas</strong> para desagregar una serie agregada distinta <img src="https://latex.codecogs.com/png.latex?X_t">. Existen tradiciones cercanas, pero cada una omite al menos uno de estos elementos:</p>
<ul>
<li><strong>Balanceo biproporcional / RAS / IPF.</strong> Ajusta matrices para casar márgenes multiplicando filas/columnas iterativamente (Deming &amp; Stephan, 1940); <strong>no</strong> construye una verosimilitud desde PCA/SVD ni entrega un <strong>posterior probabilístico en el simplex</strong> para desagregación.</li>
<li><strong>Desagregación temporal</strong> (Denton, Chow–Lin, Fernández). Distribuye agregados de baja frecuencia a alta frecuencia con series indicadoras; <strong>no</strong> aborda desagregación <strong>transversal</strong> con pesos en el simplex ni usa verosimilitudes derivadas de PCA.</li>
<li><strong>Reconciliación de pronósticos jerárquicos</strong> (p.&nbsp;ej., MinT). Proyecta pronósticos en subespacios coherentes; enfoque de pronóstico y no una actualización bayesiana para pesos composicionales.</li>
</ul>
</section>
<section id="referencias" class="level2">
<h2 class="anchored" data-anchor-id="referencias">9.2. Referencias</h2>
<p>Deming, W. E., &amp; Stephan, F. F. (1940). <em>The Annals of Mathematical Statistics, 11</em>(4), 427–444. <a href="https://doi.org/10.1214/aoms/1177731829">https://doi.org/10.1214/aoms/1177731829</a> Eurostat. (2013). <em>Handbook on quarterly national accounts</em>. ILO/IMF/OECD/Eurostat/UNECE/World Bank (2020). <em>Consumer Price Index Manual: Concepts and Methods</em>. Wickramasuriya, S. L., Athanasopoulos, G., &amp; Hyndman, R. J. (2019). <em>Statistica Sinica, 30</em>(4), 1555–1586. (Preprint: arXiv:1805.07245).</p>
</section>
<section id="aplicaciones-económicas" class="level2">
<h2 class="anchored" data-anchor-id="aplicaciones-económicas">9.3. Aplicaciones económicas</h2>
<section id="desagregación-del-índice-de-precios-al-consumidor" class="level3">
<h3 class="anchored" data-anchor-id="desagregación-del-índice-de-precios-al-consumidor">9.3.1. Desagregación del Índice de Precios al Consumidor</h3>
<p>La herramienta habilita análisis antes inviables: identificación de sectores impulsores de la inflación, evaluación del impacto diferencial de choques de precios y seguimiento de la dinámica sectorial de precios.</p>
</section>
</section>
<section id="aplicaciones-más-allá-de-la-economía" class="level2">
<h2 class="anchored" data-anchor-id="aplicaciones-más-allá-de-la-economía">9.4. Aplicaciones más allá de la economía</h2>
<p>El marco se generaliza a cualquier dominio con <strong>transferencia de estructura</strong>: neurociencia, clima (downscaling con incertidumbre), epidemiología, procesamiento de señales y aprendizaje automático (adaptación de dominio con representaciones intermedias ruidosas).</p>
</section>
<section id="impacto-práctico" class="level2">
<h2 class="anchored" data-anchor-id="impacto-práctico">9.5. Impacto práctico</h2>
<p>Posibilita que bancos centrales, investigadores y analistas descompongan choques agregados en componentes sectoriales y diseñen intervenciones basadas en dinámica granular de precios.</p>


</section>

 ]]></description>
  <category>R</category>
  <category>packages</category>
  <category>Bayesian</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-17-desagregacion-bayesiana/</guid>
  <pubDate>Wed, 17 Sep 2025 06:00:00 GMT</pubDate>
</item>
<item>
  <title>EconCausal: Bayesian &amp; Econometric Tools for Predictive Causality</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-18-econcausal/</link>
  <description><![CDATA[ 





<blockquote class="blockquote">
<p>This article presents the <strong>EconCausal</strong> library: a compact toolkit for <strong>predictive causal assessment</strong> between production and circulation variables with <strong>time-aware validation</strong>. The library exposes three engines—(1) Bayesian GLM with AR(1) errors, (2) Bayesian State-Space (BSTS) with spike-and-slab selection, and (3) an ECM enhanced with MARS—so practitioners can trade off structural transparency, predictive sharpness, and computational cost while keeping evaluation on out-of-sample grounds.</p>
</blockquote>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">1. Overview</h2>
<p>EconCausal implements a <strong>diagnostics-first</strong> workflow. Each engine is paired with <strong>Leave-Future-Out (LFO)</strong> rolling evaluation, reporting <strong>Expected Log Predictive Density (ELPD)</strong> alongside classical error metrics. Stability is summarized as <strong>support</strong>, i.e., the fraction of rolling folds where the full model <strong>wins</strong> against a strict baseline.</p>
<section id="why-three-engines" class="level3">
<h3 class="anchored" data-anchor-id="why-three-engines">Why three engines?</h3>
<ul>
<li><strong>GLM-AR(1)</strong>: fast Bayesian regression with AR(1) errors; ideal when a small set of lags is economically motivated and serial correlation must be handled explicitly.</li>
<li><strong>BSTS + spike-and-slab</strong>: structural trend/level (and optional seasonality) with automatic predictor selection; strongest when <strong>decomposition</strong> and <strong>calibrated intervals</strong> matter.</li>
<li><strong>ECM + MARS</strong>: hybrid frequentist benchmark for <strong>cointegrated</strong> pairs that may exhibit <strong>nonlinear</strong> short-run corrections.</li>
</ul>
<p>The three are deliberately different: <strong>parametric Bayesian</strong>, <strong>structural Bayesian</strong>, and <strong>hybrid frequentist</strong>—so results can be triangulated across assumptions.</p>
</section>
</section>
<section id="engines" class="level2">
<h2 class="anchored" data-anchor-id="engines">2. Engines</h2>
<section id="bayesian-glm-with-ar1-errors-bglm-ar1" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-glm-with-ar1-errors-bglm-ar1">2.1. Bayesian GLM with AR(1) Errors (BGLM-AR1)</h3>
<p><strong>Model.</strong> The standardized outcome <img src="https://latex.codecogs.com/png.latex?Y_%7Bt,s%7D"> is regressed on a standardized time index <img src="https://latex.codecogs.com/png.latex?t_s"> and standardized lags of <img src="https://latex.codecogs.com/png.latex?X">, with AR(1) residuals:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_%7Bt,s%7D=%5Calpha+%5Cbeta_0%20t_s+%5Csum_%7Bi=1%7D%5EL%20%5Cbeta_i%20X_%7Bt-i,s%7D+%5Cepsilon_t,%5Cquad%20%5Cepsilon_t=%5Cphi%20%5Cepsilon_%7Bt-1%7D+%5Ceta_t.%0A"></p>
<p>Standardization is critical for efficient HMC/NUTS.</p>
<p><strong>Baseline.</strong> <img src="https://latex.codecogs.com/png.latex?Y_%7Bt,s%7D%5Csim%201+t_s+%5Ctext%7BAR(1)%7D"> provides the <strong>null</strong> without <img src="https://latex.codecogs.com/png.latex?X">-information for strict OOS comparisons.</p>
<p><strong>Priors.</strong> Weakly informative: <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5Csim%20N(0,1)">, <img src="https://latex.codecogs.com/png.latex?%5Calpha%5Csim%20t_3(0,2.5)">, <img src="https://latex.codecogs.com/png.latex?%5Csigma%5Csim%5Ctext%7BExp%7D(1)">; <img src="https://latex.codecogs.com/png.latex?%5Cphi%5Cin(-1,1)">.</p>
<p><strong>Sampling &amp; diagnostics.</strong> 4 chains, 1500 iters, warmup 750, <code>adapt_delta=0.95</code>, <code>max_treedepth=12</code>; R-hat &lt; 1.01, ESS &gt; 400, zero/few divergences.</p>
<p><strong>Temporal validation.</strong> LFO with <strong>sliding</strong> window; a fold is a <strong>victory</strong> if <img src="https://latex.codecogs.com/png.latex?%5CDelta">ELPD &gt; 0 <strong>and</strong> RMSE decreases. Support = wins / folds. Thresholds: <strong>0.70</strong> (strict), <strong>0.60</strong> (moderate).</p>
<p><strong>Function.</strong> <code>bglmar1()</code> orchestrates the entire pipeline (I/O, scaling per-fold, AR(1) fits via <code>brms/cmdstanr</code>, metrics, ranking, and CSV export). Key arguments include <code>max_lag</code>, <code>initial_frac</code>, <code>initial_min</code>, <code>test_h</code>, <code>step_h</code>, and MCMC controls.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example (disabled for speed)</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># result &lt;- bglmar1(</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data_path = "path/to/data.xlsx",</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   circ_vars = c("TC_SPOT_CAN_US","TC_SPOT_US_CAN","TC_SPOT_US_REMB",</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "IPC","TdI_LdelT","TasaDescuento"),</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   prod_vars = c("ValorExportaciones","Real_Net_Profit",</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "RealSocialConsumptionPerWorker2017","RealWage_PPP2017",</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "CapitalStock_PPP2017","LaborProductivity_PPP2017",</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "InvestmentPerWorker_PPP2017"),</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   max_lag = 3, test_h = 12, step_h = 12</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
</section>
<section id="bayesian-structural-time-series-with-spike-and-slab-bsts" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-structural-time-series-with-spike-and-slab-bsts">2.2. Bayesian Structural Time Series with Spike-and-Slab (BSTS)</h3>
<p><strong>Framework.</strong> Two-equation state-space:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Bobs:%20%7D%20y_t%20=%20Z_t'%20%5Calpha_t%20+%20%5Cbeta'%20x_t%20+%20%5Cepsilon_t,%5Cquad%0A%5Ctext%7Bstate:%20%7D%20%5Calpha_%7Bt+1%7D%20=%20T_t%20%5Calpha_t%20+%20R_t%20%5Ceta_t,%0A"></p>
<p>with structural components for <strong>level</strong>, <strong>trend</strong> (optional), and <strong>seasonality</strong> (optional).</p>
<p><strong>Selection.</strong> Spike-and-slab priors perform <strong>automatic variable selection</strong> over lagged regressors.</p>
<p><strong>Validation.</strong> LFO with <strong>expanding</strong> window (init 80%, horizon 6, step 6). Victory if <img src="https://latex.codecogs.com/png.latex?%5CDelta">ELPD &gt; 0 and <img src="https://latex.codecogs.com/png.latex?%5CDelta">RMSE &gt; 0 (note: defined as RMSE<img src="https://latex.codecogs.com/png.latex?_%5Ctext%7Bbase%7D">-RMSE<img src="https://latex.codecogs.com/png.latex?_%5Ctext%7Bfull%7D">). Support and thresholds as above.</p>
<p><strong>Function.</strong> <code>bsts_model()</code> tunes <strong>LL vs LLT</strong>, runs MCMC (2000 iters, burn 500), computes ELPD/coverage/PIT, ranks pairs, and writes CSV outputs. Arguments include <code>max_lag</code>, <code>seasonality</code>, and LFO controls.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example (disabled for speed)</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ss &lt;- bsts_model(</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data_path = "path/to/data.xlsx",</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   circ_vars = c("TC_SPOT_CAN_US","TC_SPOT_US_CAN","TC_SPOT_US_REMB",</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "IPC","TdI_LdelT","TasaDescuento"),</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   prod_vars = c("ValorExportaciones","Real_Net_Profit",</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "RealSocialConsumptionPerWorker2017","RealWage_PPP2017",</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "CapitalStock_PPP2017","LaborProductivity_PPP2017",</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "InvestmentPerWorker_PPP2017"),</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   lfo_h = 6, lfo_step = 6, seasonality = 12</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
</section>
<section id="error-correction-with-mars-ecm-mars" class="level3">
<h3 class="anchored" data-anchor-id="error-correction-with-mars-ecm-mars">2.3. Error-Correction with MARS (ECM-MARS)</h3>
<p><strong>Purpose.</strong> A robust frequentist benchmark for <strong>cointegrated</strong> pairs, augmenting linear ECM with <strong>MARS splines</strong> to capture <strong>nonlinear short-run adjustment</strong>. Rolling CV and nested tuning are included to guard against overfitting.</p>
<p><strong>Function.</strong> <code>ecm_mars()</code> accepts production/circulation sets, cointegration rule (Engle-Granger or Johansen), and a MARS grid; it performs rolling validation, filters by minimum support, and returns a tidy results table.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example (disabled for speed)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ec &lt;- ecm_mars(</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data_path = "path/to/data.xlsx",</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   circ_vars = c("ER.SPOT.CAN.US","ER.SPOT.US.CAN","ER.SPOT.US.REMB",</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "CPI","TreasuryBonds10y","FedDiscountRate"),</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   prod_vars = c("Exports","RealNetProfit","RealSocialConsumptionPerWorker2017",</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "RealWagePPP2017","CapitalStockPPP2017",</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "LaborProductivityPPP2017","InvestmentPerWorkerPPP2017"),</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   cointeg_rule = "either"</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
</section>
</section>
<section id="validation-metrics" class="level2">
<h2 class="anchored" data-anchor-id="validation-metrics">3. Validation &amp; Metrics</h2>
<p><strong>Principle.</strong> Models are compared <strong>out-of-sample</strong> with two orthogonal criteria:</p>
<ul>
<li><strong>ELPD</strong> for probabilistic fit (predictive density on future data).</li>
<li><strong>RMSE</strong> (plus MAE, sMAPE, <img src="https://latex.codecogs.com/png.latex?R%5E2">) for point accuracy on the original scale.</li>
</ul>
<p>A fold <strong>wins</strong> only if it improves <strong>both</strong>. The <strong>support</strong> statistic (wins / folds) summarizes temporal stability; results are ranked by <strong>support</strong>, then <img src="https://latex.codecogs.com/png.latex?%5CDelta">ELPD, then <img src="https://latex.codecogs.com/png.latex?%5CDelta">RMSE.</p>
</section>
<section id="quickstart-deferred-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="quickstart-deferred-evaluation">4. Quickstart (deferred evaluation)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GLM-AR(1)</span></span>
<span id="cb4-3">res_glm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bglmar1</span>(</span>
<span id="cb4-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"path/to/data.xlsx"</span>,</span>
<span id="cb4-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circ_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prod_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>),</span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test_h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">step_h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb4-7">)</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BSTS</span></span>
<span id="cb4-10">res_ss <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bsts_model</span>(</span>
<span id="cb4-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"path/to/data.xlsx"</span>,</span>
<span id="cb4-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circ_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prod_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>),</span>
<span id="cb4-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lfo_h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lfo_step =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb4-14">)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ECM-MARS</span></span>
<span id="cb4-17">res_ecm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecm_mars</span>(</span>
<span id="cb4-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"path/to/data.xlsx"</span>,</span>
<span id="cb4-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circ_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prod_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>),</span>
<span id="cb4-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cointeg_rule =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"either"</span></span>
<span id="cb4-21">)</span></code></pre></div></div>
</section>
<section id="outputs-reading-the-results" class="level2">
<h2 class="anchored" data-anchor-id="outputs-reading-the-results">5. Outputs &amp; Reading the Results</h2>
<p>Each runner writes <strong>rankings</strong> and <strong>winner lists</strong> (support ≥ 0.70 / 0.60) and, for BSTS, <strong>coverage/PIT</strong> diagnostics. CSV exports are provided for quick inspection or downstream reporting.</p>
</section>
<section id="design-choices-trade-offs" class="level2">
<h2 class="anchored" data-anchor-id="design-choices-trade-offs">6. Design Choices &amp; Trade-offs</h2>
<ul>
<li><strong>Per-fold scaling</strong> prevents data leakage and keeps HMC on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D(1)"> scales.</li>
<li><strong>Dual criteria</strong> (ELPD + RMSE) filter single-metric mirages.</li>
<li><strong>Engine diversity</strong> enables <strong>triangulation</strong> across assumptions (AR(1) vs structural components vs cointegration + nonlinearity).</li>
</ul>
</section>
<section id="when-to-use-which" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use-which">7. When to Use Which</h2>
<ul>
<li>Prefer <strong>GLM-AR1</strong> for compact lag structures and clear serial dependence.</li>
<li>Prefer <strong>BSTS</strong> for decomposition, calibrated intervals, and automatic selection.</li>
<li>Prefer <strong>ECM-MARS</strong> when cointegration is theoretically warranted and nonlinearity in corrections is expected.</li>
</ul>
<hr>
<section id="notes-method-sources" class="level3">
<h3 class="anchored" data-anchor-id="notes-method-sources">Notes &amp; Method Sources</h3>
<p>Concise method notes were adapted from the package’s methodological documents and function headers. See the detailed <strong>BGLM-AR1</strong> write-up (model, priors, LFO, diagnostics), the <strong>BSTS</strong> framework (state equations, selection, validation), and the <strong>ECM-MARS</strong> protocol (I(1), cointegration, MARS tuning).</p>
<hr>
<section id="reproducibility-switch" class="level4">
<h4 class="anchored" data-anchor-id="reproducibility-switch">Reproducibility switch</h4>
<p>Set chunk <code>eval: false</code> to <code>true</code> for live runs. Heavy models (BSTS and BGLM) use MCMC; disable evaluation for speed on blog render.</p>
<hr>
<p><em>Project page:</em> <a href="https://github.com/IsadoreNabi/EconCausal">https://github.com/IsadoreNabi/EconCausal</a></p>


</section>
</section>
</section>

 ]]></description>
  <category>R</category>
  <category>packages</category>
  <category>Bayesian</category>
  <category>econometrics</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-18-econcausal/</guid>
  <pubDate>Wed, 17 Sep 2025 06:00:00 GMT</pubDate>
</item>
<item>
  <title>EconCausal: Herramientas Bayesianas y Econométricas para Causalidad Predictiva</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-18-econcausal-esp/</link>
  <description><![CDATA[ 





<blockquote class="blockquote">
<p>Este artículo presenta la biblioteca <strong>EconCausal</strong>: un conjunto compacto de herramientas para la <strong>evaluación causal predictiva</strong> entre variables de producción y circulación con <strong>validación temporal</strong>. La biblioteca expone tres motores—(1) GLM Bayesiano con errores AR(1), (2) State-Space Bayesiano (BSTS) con selección spike-and-slab, y (3) un ECM mejorado con MARS—para que los profesionales puedan equilibrar transparencia estructural, precisión predictiva y costo computacional mientras mantienen la evaluación en terreno fuera de muestra.</p>
</blockquote>
<section id="visión-general" class="level2">
<h2 class="anchored" data-anchor-id="visión-general">1. Visión General</h2>
<p>EconCausal implementa un flujo de trabajo <strong>primero-los-diagnósticos</strong>. Cada motor está emparejado con evaluación rodante <strong>Leave-Future-Out (LFO)</strong>, reportando <strong>Densidad Predictiva Logarítmica Esperada (ELPD)</strong> junto con métricas de error clásicas. La estabilidad se resume como <strong>soporte</strong>, es decir, la fracción de pliegues rodantes donde el modelo completo <strong>gana</strong> contra una línea base estricta.</p>
<section id="por-qué-tres-motores" class="level3">
<h3 class="anchored" data-anchor-id="por-qué-tres-motores">¿Por qué tres motores?</h3>
<ul>
<li><strong>GLM-AR(1)</strong>: regresión Bayesiana rápida con errores AR(1); ideal cuando un pequeño conjunto de rezagos está motivado económicamente y la correlación serial debe manejarse explícitamente.</li>
<li><strong>BSTS + spike-and-slab</strong>: tendencia/nivel estructural (y estacionalidad opcional) con selección automática de predictores; más fuerte cuando importan la <strong>descomposición</strong> y los <strong>intervalos calibrados</strong>.</li>
<li><strong>ECM + MARS</strong>: punto de referencia frecuentista híbrido para pares <strong>cointegrados</strong> que pueden exhibir correcciones de corto plazo <strong>no lineales</strong>.</li>
</ul>
<p>Los tres son deliberadamente diferentes: <strong>Bayesiano paramétrico</strong>, <strong>Bayesiano estructural</strong>, y <strong>frecuentista híbrido</strong>—para que los resultados puedan triangularse entre supuestos.</p>
</section>
</section>
<section id="motores" class="level2">
<h2 class="anchored" data-anchor-id="motores">2. Motores</h2>
<section id="glm-bayesiano-con-errores-ar1-bglm-ar1" class="level3">
<h3 class="anchored" data-anchor-id="glm-bayesiano-con-errores-ar1-bglm-ar1">2.1. GLM Bayesiano con Errores AR(1) (BGLM-AR1)</h3>
<p><strong>Modelo.</strong> El resultado estandarizado <img src="https://latex.codecogs.com/png.latex?Y_%7Bt,s%7D"> se regresa sobre un índice temporal estandarizado <img src="https://latex.codecogs.com/png.latex?t_s"> y rezagos estandarizados de <img src="https://latex.codecogs.com/png.latex?X">, con residuales AR(1):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_%7Bt,s%7D=%5Calpha+%5Cbeta_0%20t_s+%5Csum_%7Bi=1%7D%5EL%20%5Cbeta_i%20X_%7Bt-i,s%7D+%5Cepsilon_t,%5Cquad%20%5Cepsilon_t=%5Cphi%20%5Cepsilon_%7Bt-1%7D+%5Ceta_t.%0A"></p>
<p>La estandarización es crítica para HMC/NUTS eficiente.</p>
<p><strong>Línea base.</strong> <img src="https://latex.codecogs.com/png.latex?Y_%7Bt,s%7D%5Csim%201+t_s+%5Ctext%7BAR(1)%7D"> proporciona el <strong>nulo</strong> sin información de <img src="https://latex.codecogs.com/png.latex?X"> para comparaciones OOS estrictas.</p>
<p><strong>Priors.</strong> Débilmente informativos: <img src="https://latex.codecogs.com/png.latex?%5Cbeta%5Csim%20N(0,1)">, <img src="https://latex.codecogs.com/png.latex?%5Calpha%5Csim%20t_3(0,2.5)">, <img src="https://latex.codecogs.com/png.latex?%5Csigma%5Csim%5Ctext%7BExp%7D(1)">; <img src="https://latex.codecogs.com/png.latex?%5Cphi%5Cin(-1,1)">.</p>
<p><strong>Muestreo y diagnósticos.</strong> 4 cadenas, 1500 iters, calentamiento 750, <code>adapt_delta=0.95</code>, <code>max_treedepth=12</code>; R-hat &lt; 1.01, ESS &gt; 400, cero/pocas divergencias.</p>
<p><strong>Validación temporal.</strong> LFO con ventana <strong>deslizante</strong>; un pliegue es una <strong>victoria</strong> si <img src="https://latex.codecogs.com/png.latex?%5CDelta">ELPD &gt; 0 <strong>y</strong> RMSE disminuye. Soporte = victorias / pliegues. Umbrales: <strong>0.70</strong> (estricto), <strong>0.60</strong> (moderado).</p>
<p><strong>Función.</strong> <code>bglmar1()</code> orquesta todo el pipeline (E/S, escalado por pliegue, ajustes AR(1) vía <code>brms/cmdstanr</code>, métricas, ranking, y exportación CSV). Los argumentos clave incluyen <code>max_lag</code>, <code>initial_frac</code>, <code>initial_min</code>, <code>test_h</code>, <code>step_h</code>, y controles MCMC.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ejemplo (deshabilitado por velocidad)</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># resultado &lt;- bglmar1(</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data_path = "ruta/a/datos.xlsx",</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   circ_vars = c("TC_SPOT_CAN_US","TC_SPOT_US_CAN","TC_SPOT_US_REMB",</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "IPC","TdI_LdelT","TasaDescuento"),</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   prod_vars = c("ValorExportaciones","Real_Net_Profit",</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "RealSocialConsumptionPerWorker2017","RealWage_PPP2017",</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "CapitalStock_PPP2017","LaborProductivity_PPP2017",</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "InvestmentPerWorker_PPP2017"),</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   max_lag = 3, test_h = 12, step_h = 12</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
</section>
<section id="series-de-tiempo-estructurales-bayesianas-con-spike-and-slab-bsts" class="level3">
<h3 class="anchored" data-anchor-id="series-de-tiempo-estructurales-bayesianas-con-spike-and-slab-bsts">2.2. Series de Tiempo Estructurales Bayesianas con Spike-and-Slab (BSTS)</h3>
<p><strong>Marco de trabajo.</strong> State-space de dos ecuaciones:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Bobs:%20%7D%20y_t%20=%20Z_t'%20%5Calpha_t%20+%20%5Cbeta'%20x_t%20+%20%5Cepsilon_t,%5Cquad%0A%5Ctext%7Bestado:%20%7D%20%5Calpha_%7Bt+1%7D%20=%20T_t%20%5Calpha_t%20+%20R_t%20%5Ceta_t,%0A"></p>
<p>con componentes estructurales para <strong>nivel</strong>, <strong>tendencia</strong> (opcional), y <strong>estacionalidad</strong> (opcional).</p>
<p><strong>Selección.</strong> Los priors spike-and-slab realizan <strong>selección automática de variables</strong> sobre regresores rezagados.</p>
<p><strong>Validación.</strong> LFO con ventana <strong>expansiva</strong> (init 80%, horizonte 6, paso 6). Victoria si <img src="https://latex.codecogs.com/png.latex?%5CDelta">ELPD &gt; 0 y <img src="https://latex.codecogs.com/png.latex?%5CDelta">RMSE &gt; 0 (nota: definido como RMSE<img src="https://latex.codecogs.com/png.latex?_%5Ctext%7Bbase%7D">-RMSE<img src="https://latex.codecogs.com/png.latex?_%5Ctext%7Bcompleto%7D">). Soporte y umbrales como arriba.</p>
<p><strong>Función.</strong> <code>bsts_model()</code> afina <strong>LL vs LLT</strong>, ejecuta MCMC (2000 iters, quemado 500), calcula ELPD/cobertura/PIT, clasifica pares, y escribe salidas CSV. Los argumentos incluyen <code>max_lag</code>, <code>seasonality</code>, y controles LFO.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ejemplo (deshabilitado por velocidad)</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ss &lt;- bsts_model(</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data_path = "ruta/a/datos.xlsx",</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   circ_vars = c("TC_SPOT_CAN_US","TC_SPOT_US_CAN","TC_SPOT_US_REMB",</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "IPC","TdI_LdelT","TasaDescuento"),</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   prod_vars = c("ValorExportaciones","Real_Net_Profit",</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "RealSocialConsumptionPerWorker2017","RealWage_PPP2017",</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "CapitalStock_PPP2017","LaborProductivity_PPP2017",</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "InvestmentPerWorker_PPP2017"),</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   lfo_h = 6, lfo_step = 6, seasonality = 12</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
</section>
<section id="corrección-de-error-con-mars-ecm-mars" class="level3">
<h3 class="anchored" data-anchor-id="corrección-de-error-con-mars-ecm-mars">2.3. Corrección de Error con MARS (ECM-MARS)</h3>
<p><strong>Propósito.</strong> Un punto de referencia frecuentista robusto para pares <strong>cointegrados</strong>, aumentando ECM lineal con <strong>splines MARS</strong> para capturar <strong>ajuste no lineal de corto plazo</strong>. Se incluyen CV rodante y ajuste anidado para proteger contra sobreajuste.</p>
<p><strong>Función.</strong> <code>ecm_mars()</code> acepta conjuntos de producción/circulación, regla de cointegración (Engle-Granger o Johansen), y una cuadrícula MARS; realiza validación rodante, filtra por soporte mínimo, y devuelve una tabla de resultados ordenada.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ejemplo (deshabilitado por velocidad)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ec &lt;- ecm_mars(</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data_path = "ruta/a/datos.xlsx",</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   circ_vars = c("ER.SPOT.CAN.US","ER.SPOT.US.CAN","ER.SPOT.US.REMB",</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "CPI","TreasuryBonds10y","FedDiscountRate"),</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   prod_vars = c("Exports","RealNetProfit","RealSocialConsumptionPerWorker2017",</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "RealWagePPP2017","CapitalStockPPP2017",</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "LaborProductivityPPP2017","InvestmentPerWorkerPPP2017"),</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   cointeg_rule = "either"</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span></code></pre></div></div>
</section>
</section>
<section id="validación-y-métricas" class="level2">
<h2 class="anchored" data-anchor-id="validación-y-métricas">3. Validación y Métricas</h2>
<p><strong>Principio.</strong> Los modelos se comparan <strong>fuera de muestra</strong> con dos criterios ortogonales:</p>
<ul>
<li><strong>ELPD</strong> para ajuste probabilístico (densidad predictiva en datos futuros).</li>
<li><strong>RMSE</strong> (más MAE, sMAPE, <img src="https://latex.codecogs.com/png.latex?R%5E2">) para precisión puntual en la escala original.</li>
</ul>
<p>Un pliegue <strong>gana</strong> solo si mejora <strong>ambos</strong>. El estadístico de <strong>soporte</strong> (victorias / pliegues) resume la estabilidad temporal; los resultados se clasifican por <strong>soporte</strong>, luego <img src="https://latex.codecogs.com/png.latex?%5CDelta">ELPD, luego <img src="https://latex.codecogs.com/png.latex?%5CDelta">RMSE.</p>
</section>
<section id="inicio-rápido-evaluación-diferida" class="level2">
<h2 class="anchored" data-anchor-id="inicio-rápido-evaluación-diferida">4. Inicio Rápido (evaluación diferida)</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| eval: false</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GLM-AR(1)</span></span>
<span id="cb4-3">res_glm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bglmar1</span>(</span>
<span id="cb4-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ruta/a/datos.xlsx"</span>,</span>
<span id="cb4-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circ_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prod_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>),</span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test_h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">step_h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb4-7">)</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BSTS</span></span>
<span id="cb4-10">res_ss <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bsts_model</span>(</span>
<span id="cb4-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ruta/a/datos.xlsx"</span>,</span>
<span id="cb4-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circ_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prod_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>),</span>
<span id="cb4-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lfo_h =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lfo_step =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb4-14">)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ECM-MARS</span></span>
<span id="cb4-17">res_ecm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ecm_mars</span>(</span>
<span id="cb4-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ruta/a/datos.xlsx"</span>,</span>
<span id="cb4-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circ_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prod_vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>),</span>
<span id="cb4-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cointeg_rule =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"either"</span></span>
<span id="cb4-21">)</span></code></pre></div></div>
</section>
<section id="salidas-y-lectura-de-resultados" class="level2">
<h2 class="anchored" data-anchor-id="salidas-y-lectura-de-resultados">5. Salidas y Lectura de Resultados</h2>
<p>Cada ejecutor escribe <strong>clasificaciones</strong> y <strong>listas de ganadores</strong> (soporte ≥ 0.70 / 0.60) y, para BSTS, diagnósticos de <strong>cobertura/PIT</strong>. Se proporcionan exportaciones CSV para inspección rápida o informes posteriores.</p>
</section>
<section id="decisiones-de-diseño-y-compensaciones" class="level2">
<h2 class="anchored" data-anchor-id="decisiones-de-diseño-y-compensaciones">6. Decisiones de Diseño y Compensaciones</h2>
<ul>
<li><strong>Escalado por pliegue</strong> previene fuga de datos y mantiene HMC en escalas <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D(1)">.</li>
<li><strong>Criterios duales</strong> (ELPD + RMSE) filtran espejismos de métrica única.</li>
<li><strong>Diversidad de motores</strong> permite <strong>triangulación</strong> entre supuestos (AR(1) vs componentes estructurales vs cointegración + no linealidad).</li>
</ul>
</section>
<section id="cuándo-usar-cuál" class="level2">
<h2 class="anchored" data-anchor-id="cuándo-usar-cuál">7. Cuándo Usar Cuál</h2>
<ul>
<li>Prefiere <strong>GLM-AR1</strong> para estructuras de rezago compactas y dependencia serial clara.</li>
<li>Prefiere <strong>BSTS</strong> para descomposición, intervalos calibrados y selección automática.</li>
<li>Prefiere <strong>ECM-MARS</strong> cuando la cointegración está teóricamente justificada y se espera no linealidad en las correcciones.</li>
</ul>
<hr>
<section id="notas-y-fuentes-de-métodos" class="level3">
<h3 class="anchored" data-anchor-id="notas-y-fuentes-de-métodos">Notas y Fuentes de Métodos</h3>
<p>Las notas concisas de métodos fueron adaptadas de los documentos metodológicos del paquete y encabezados de funciones. Ver el documento detallado de <strong>BGLM-AR1</strong> (modelo, priors, LFO, diagnósticos), el marco de <strong>BSTS</strong> (ecuaciones de estado, selección, validación), y el protocolo <strong>ECM-MARS</strong> (I(1), cointegración, ajuste MARS).</p>
<hr>
<section id="interruptor-de-reproducibilidad" class="level4">
<h4 class="anchored" data-anchor-id="interruptor-de-reproducibilidad">Interruptor de Reproducibilidad</h4>
<p>Cambia <code>eval: false</code> a <code>true</code> en los chunks para ejecuciones en vivo. Los modelos pesados (BSTS y BGLM) usan MCMC; deshabilita la evaluación por velocidad en el renderizado del blog.</p>
<hr>
<p><em>Página del proyecto:</em> <a href="https://github.com/IsadoreNabi/EconCausal">https://github.com/IsadoreNabi/EconCausal</a></p>


</section>
</section>
</section>

 ]]></description>
  <category>R</category>
  <category>paquetes</category>
  <category>Bayesiano</category>
  <category>econometría</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/2025-09-18-econcausal-esp/</guid>
  <pubDate>Wed, 17 Sep 2025 06:00:00 GMT</pubDate>
</item>
<item>
  <title>Welcome To My Blog</title>
  <dc:creator>José Mauricio Gómez Julián</dc:creator>
  <link>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/welcome/</link>
  <description><![CDATA[ 





<p>Welcome to this blog! This space is dedicated to sharing statistical tools and methods that I develop and find necessary during my research in Marxist Political Economy in particular, and Philosophy of Science in general.</p>
<p>My worldview and approach to science are grounded in Classical Marxism, drawing from the works of Marx, Engels, Lenin, Mandel, Rosdolsky, Lukács, Gramsci, Haldane, Oparin, and others. This theoretical framework informs not only the questions I ask but also how I approach methodological and analytical challenges in my research. The tools, code, and techniques I share here emerge from practical research needs, and I hope they prove useful to others working in similar areas or anyone interested in statistical applications within critical social science research.</p>
<p>This blog is a derivative of my main blog at <strong>www.marxistphilosophyofscience.com</strong>, where I explore broader theoretical and philosophical questions. Here, the focus is more technical and methodological, complementing the theoretical discussions with practical computational tools.</p>
<p>Feel free to use, adapt, and build upon anything you find here. Science, after all, is a collective endeavor.</p>
<p><img src="https://IsadoreNabi.github.io/philosophy-of-statistics/posts/welcome/PHOTO.jpg" class="img-fluid"></p>



 ]]></description>
  <category>news</category>
  <guid>https://IsadoreNabi.github.io/philosophy-of-statistics/posts/welcome/</guid>
  <pubDate>Sun, 14 Sep 2025 06:00:00 GMT</pubDate>
</item>
</channel>
</rss>
